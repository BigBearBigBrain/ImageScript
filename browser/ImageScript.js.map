{"version":3,"sources":["webpack://ImageScript/webpack/universalModuleDefinition","webpack://ImageScript/./ImageScript.js","webpack://ImageScript/./utils/buffer.js","webpack://ImageScript/./utils/crc32.js","webpack://ImageScript/./utils/png.js","webpack://ImageScript/./utils/wasm/font.js","webpack://ImageScript/./utils/wasm/gif.js","webpack://ImageScript/./utils/wasm/jpeg.js","webpack://ImageScript/./utils/wasm/svg.js","webpack://ImageScript/./utils/wasm/tiff.js","webpack://ImageScript/./utils/zlib.js","webpack://ImageScript/webpack/bootstrap","webpack://ImageScript/webpack/startup"],"names":["root","factory","exports","module","define","amd","self","png","mem","giflib","svglib","version","fontlib","jpeglib","tifflib","Image","width","height","RangeError","this","__width__","__height__","__buffer__","ArrayBuffer","__view__","DataView","__u32__","Uint32Array","bitmap","Uint8ClampedArray","Symbol","iterator","y","x","offset","getUint32","r","g","b","a","rgbaToColor","h","s","l","Math","min","max","hue2rgb","p","q","t","hslaToColor","d","color","colorToRGBA","slice","__check_boundaries__","idx","subarray","pixelColor","__set_pixel__","setUint32","isNaN","TypeError","__out_of_bounds__","fill","image","set","factor","mode","RESIZE_NEAREST_NEIGHBOR","__scale__","__apply__","__resize__","RESIZE_AUTO","Error","floor","__resize_nearest_neighbor__","constructor","ySrc","xSrc","destPos","srcPos","__crop__","tY","__fast_box__","tX","nX","nY","tC","right","xPos","end","start","bottom","copyWithin","radius","radSquared","currentY","currentX","feathering","centerX","centerY","distanceFromCenter","alphaIdx","opacity","absolute","__set_channel_value__","saturation","value","i","length","rgbaToHSLA","getRGBAAt","source","yy","y_offset","xx","x_offset","fg","bg","__alpha_blend__","fa","alpha","inv_alpha","iterateWithColors","degrees","colorAvg","divisor","rgba","map","v","ignoreBlack","ignoreWhite","bwThreshold","colorCounts","Array","key","maxColorCount","mostProminentValue","forEach","el","dominantColor","angle","resize","__rotate_180__","rad","PI","sin","cos","abs","out","out_cx","out_cy","src_cx","src_cy","w","ysin","ycos","xf","yf","__interpolate__","reverse","src","x0","y0","x1","y1","x2","y2","xq","yq","out_slice","ref","__pawn__","point0","point1","weight","src_slice","wa","Frame","from","duration","xOffset","yOffset","disposalMode","colors","entries","Object","sort","positions","e","parseFloat","values","gradient","__gradient__","position","minDef","maxDef","gradients","minPos","undefined","maxPos","minVal","maxVal","push","xRad","startColor","endColor","sr","sg","sb","sa","er","eg","eb","ea","tu32","ru32","iw","ih","xco","yco","dfc","sqrt","dis","nx","ny","cO","compression","title","author","description","copyright","creationTime","software","disclaimer","warning","comment","encode","level","channels","text","Title","Author","Description","Copyright","Date","now","toUTCString","Software","Disclaimer","Warning","Source","Comment","quality","init","data","view","buffer","byteOffset","byteLength","ImageType","isPNG","pixels","decode","isJPEG","framebuffer","pixelType","format","pixel","isTIFF","svg","size","SVG_MODE_SCALE","SVG_MODE_WIDTH","SVG_MODE_HEIGHT","includes","TextEncoder","rasterize","font","scale","layout","TextLayout","Font","Layout","layoutOptions","reset","max_width","maxWidth","max_height","maxHeight","wrap_style","wrapStyle","vertical_align","verticalAlign","horizontal_align","horizontalAlign","wrap_hard_breaks","wrapHardBreaks","append","crop","lines","free","indexOf","DISPOSAL_KEEP","__convert_disposal_mode__","super","frame","originalWidth","originalHeight","result","GIF","frames","loopCount","reduce","acc","encoder","Encoder","add","u8","onlyExtractFirstFrame","isGIF","decoder","Decoder","first","next","delay","dispose","gwidth","gheight","u32","Uint8Array","offset8","offset32","fx","fy","f8","f32","t8","t32","options","Infinity","isView","getType","shared","SharedArrayBuffer","from_parts","buffers","isArray","table","crc","bl","crc32","compress","decompress","__IHDR__","__IDAT__","__IEND__","__IEND_CRC__","HEAD","channels_to_color_type","1","2","3","4","utf8encoder","depth","tmp_offset","row_length","tmp","chunks","kb","tb","chunk","compressed","array","bpc","pixel_type","0","6","bytespp","p_offset","c_offset","palette","alphaPalette","maxSearchOffset","type","pxlOffset","filter","filter_1","filter_2","filter_3","filter_4","newPixels","pixelView","c","pa","pb","pc","mod","streaming","WebAssembly","fetch","then","arrayBuffer","new","registry","wasm","Instance","wlen","walloc","ptr","wfree","memory","encode_utf8","globalThis","Deno","core","string","decode_utf8","TextDecoder","FinalizationRegistry","font_free","layout_free","alloc","font_new","register","unregister","char","font_has","String","prototype","charCodeAt","call","font_metrics","metrics","JSON","parse","font_metrics_buffer","font_metrics_free","font_rasterize","glyph","font_rasterize_buffer","font_rasterize_metrics","font_rasterize_free","layout_new","refs","layout_clear","layout_lines","stringify","layout_reset","has_color","layout_append","layout_rasterize","layout_rasterize_width","layout_rasterize_height","layout_rasterize_buffer","layout_rasterize_free","streams","Map","env","id","get","cb","loops","slices","encoder_new","encoder_free","delete","sum","encoder_add","encoder_add_comment","application","encoder_add_application","limit","bptr","decoder_new","decoder_width","decoder_height","decoder_free","decoder_frame","decoder_frame_x","decoder_frame_y","decoder_frame_delay","decoder_frame_width","decoder_frame_height","decoder_frame_dispose","decoder_frame_buffer","decoder_frame_free","copy_and_free","decode_width","decode_height","decode_format","decode_buffer","decode_free","fit","rasterize_width","rasterize_height","rasterize_buffer","rasterize_free","u16","Uint16Array","fleb","fdeb","clim","freb","j","_a","fl","revfl","_b","fd","revfd","rev","hMap","cd","mb","co","le","rvb","sv","r_1","m","flt","fdt","flm","flrm","fdm","fdrm","bits","o","bits16","shft","slc","n","wbits","wbits16","hTree","f","t2","et","i0","i1","i2","maxSym","tr","mbt","ln","dt","lft","cst","i2_1","i2_2","i2_3","lc","cl","cli","cln","cls","clen","cf","wfblk","pos","dat","wblk","final","syms","lf","df","li","bs","_a2","dlt","mlb","_b2","ddt","mdb","_c","lclt","nlc","_d","lcdt","ndc","lcfreq","_e","lct","mlcb","nlcc","lm","ll","dm","dl","flen","ftlen","dtlen","llm","lcts","it","clct","len","dst","deo","zlibSync","opts","adler","lv","fl2","opt","pre","post","st","lvl","plvl","lst","ceil","msk_1","prev","head","bs1_1","bs2_1","hsh","lc_1","wi","hv","imod","pimod","rem","ch_1","dif","maxn","maxd","ml","nl","mmd","md","ti","lin","din","dflt","log","wbytes","buf","sl","noBuf","noSt","cbuf","l2","nbuf","bt","lbt","dbt","tbts","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","lms","dms","lpos","sym","dsym","inflt","zlv","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__"],"mappings":"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","file":"ImageScript.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ImageScript\"] = factory();\n\telse\n\t\troot[\"ImageScript\"] = factory();\n})(self, function() {\nreturn ","const png = require('./utils/png');\nconst mem = require('./utils/buffer.js');\nconst giflib = require('./utils/wasm/gif');\nconst svglib = require('./utils/wasm/svg');\nconst {version} = require('./package.json');\nconst fontlib = require('./utils/wasm/font');\nconst jpeglib = require('./utils/wasm/jpeg');\nconst tifflib = require('./utils/wasm/tiff');\n\nconst MAGIC_NUMBERS = {\n    PNG: 0x89504e47,\n    JPEG: 0xffd8ff,\n    TIFF: 0x49492a00,\n    GIF: 0x474946\n};\n\n/**\n * Represents an image; provides utility functions\n */\nclass Image {\n    /**\n     * Creates a new image with the given dimensions\n     * @param {number} width\n     * @param {number} height\n     * @returns {Image}\n     */\n    constructor(width, height) {\n        width = ~~width;\n        height = ~~height;\n\n        if (width < 1)\n            throw new RangeError('Image has to be at least 1 pixel wide');\n        if (height < 1)\n            throw new RangeError('Image has to be at least 1 pixel high');\n\n        /** @private */\n        this.__width__ = width;\n        /** @private */\n        this.__height__ = height;\n        /** @private */\n        this.__buffer__ = new ArrayBuffer(width * height * 4);\n        /** @private */\n        this.__view__ = new DataView(this.__buffer__);\n        /** @private */\n        this.__u32__ = new Uint32Array(this.__buffer__);\n        /**\n         * The images RGBA pixel data\n         * @type {Uint8ClampedArray}\n         */\n        this.bitmap = new Uint8ClampedArray(this.__buffer__);\n    }\n\n    /**\n     * @private\n     * @returns {string}\n     */\n    toString() {\n        return `Image<${this.width}x${this.height}>`;\n    }\n\n    /**\n     * The images width\n     * @returns {number}\n     */\n    get width() {\n        return this.__width__;\n    }\n\n    /**\n     * The images height\n     * @returns {number}\n     */\n    get height() {\n        return this.__height__;\n    }\n\n    /**\n     * Yields an [x, y] array for every pixel in the image\n     * @yields {number[]} The coordinates of the pixel ([x, y])\n     * @returns {void}\n     */\n    * [Symbol.iterator]() {\n        for (let y = 1; y <= this.height; y++) {\n            for (let x = 1; x <= this.width; x++) {\n                yield [x, y];\n            }\n        }\n    }\n\n    /**\n     * Yields an [x, y, color] array for every pixel in the image\n     * @yields {number[]} The coordinates and color of the pixel ([x, y, color])\n     */\n    * iterateWithColors() {\n        let offset = 0;\n        for (let y = 1; y <= this.height; y++) {\n            for (let x = 1; x <= this.width; x++) {\n                yield [x, y, this.__view__.getUint32(offset, false)];\n                offset += 4;\n            }\n        }\n    }\n\n    /**\n     * Converts RGBA components to an RGBA value\n     * @param {number} r red (0..255)\n     * @param {number} g green (0..255)\n     * @param {number} b blue (0..255)\n     * @param {number} a alpha (0..255)\n     * @returns {number} RGBA value\n     */\n    static rgbaToColor(r, g, b, a) {\n        return (((r & 0xff) << 24) | ((g & 0xff) << 16) | ((b & 0xff) << 8) | (a & 0xff)) >>> 0;\n    }\n\n    /**\n     * Converts RGB components to an RGBA value (assuming alpha = 255)\n     * @param {number} r red (0..255)\n     * @param {number} g green (0..255)\n     * @param {number} b blue (0..255)\n     * @returns {number} RGBA value\n     */\n    static rgbToColor(r, g, b) {\n        return Image.rgbaToColor(r, g, b, 0xff);\n    }\n\n    /**\n     * Converts HSLA colors to RGBA colors\n     * @param {number} h hue (0..1)\n     * @param {number} s saturation (0..1)\n     * @param {number} l lightness (0..1)\n     * @param {number} a opacity (0..1)\n     * @returns {number} color\n     */\n    static hslaToColor(h, s, l, a) {\n        h %= 1;\n        s = Math.min(1, Math.max(0, s));\n        l = Math.min(1, Math.max(0, l));\n        a = Math.min(1, Math.max(0, a));\n\n        let r, g, b;\n\n        if (s === 0) {\n            r = g = b = l;\n        } else {\n            const hue2rgb = (p, q, t) => {\n                if (t < 0) t += 1;\n                if (t > 1) t -= 1;\n                if (t < 1 / 6) return p + (q - p) * 6 * t;\n                if (t < 1 / 2) return q;\n                if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n                return p;\n            };\n\n            const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n            const p = 2 * l - q;\n\n            r = hue2rgb(p, q, h + 1 / 3);\n            g = hue2rgb(p, q, h);\n            b = hue2rgb(p, q, h - 1 / 3);\n        }\n\n        return Image.rgbaToColor(r * 255, g * 255, b * 255, a * 255);\n    }\n\n    /**\n     * Converts HSL colors to RGBA colors (assuming an opacity of 255)\n     * @param {number} h hue (0..1)\n     * @param {number} s saturation (0..1)\n     * @param {number} l lightness (0..1)\n     * @returns {number} color\n     */\n    static hslToColor(h, s, l) {\n        return Image.hslaToColor(h, s, l, 1);\n    }\n\n    /**\n     * Converts an RGBA value to an array of HSLA values\n     * @param r {number} (0..255)\n     * @param g {number} (0..255)\n     * @param b {number} (0..255)\n     * @param a {number} (0..255)\n     * @returns {number[]} The HSLA values ([H, S, L, A])\n     */\n    static rgbaToHSLA(r, g, b, a) {\n        r /= 255;\n        g /= 255;\n        b /= 255;\n\n        const max = Math.max(r, g, b), min = Math.min(r, g, b);\n        let h, s, l = (max + min) / 2;\n\n        if (max === min) {\n            h = s = 0;\n        } else {\n            const d = max - min;\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n            switch (max) {\n                case r:\n                    h = (g - b) / d + (g < b ? 6 : 0);\n                    break;\n                case g:\n                    h = (b - r) / d + 2;\n                    break;\n                case b:\n                    h = (r - g) / d + 4;\n                    break;\n            }\n\n            h /= 6;\n        }\n\n        return [h, s, l, a / 255];\n    }\n\n    /**\n     * Converts a color value to an array of RGBA values\n     * @param {number} color The color value to convert\n     * @returns {number[]} The RGBA values ([R, G, B, A])\n     */\n    static colorToRGBA(color) {\n        return [(color >> 24) & 0xff, (color >> 16) & 0xff, (color >> 8) & 0xff, color & 0xff];\n    }\n\n    /**\n     * Converts a color value to an array of RGB values (ignoring the colors alpha)\n     * @param {number} color The color value to convert\n     * @returns {number[]} The RGB values ([R, G, B])\n     */\n    static colorToRGB(color) {\n        return Image.colorToRGBA(color).slice(0, 3);\n    }\n\n    /**\n     * Gets the pixel color at the specified position\n     * @param {number} x\n     * @param {number} y\n     * @returns {number} The color value\n     */\n    getPixelAt(x, y) {\n        this.__check_boundaries__(x, y);\n        return this.__view__.getUint32(((~~y - 1) * this.width + (~~x - 1)) * 4, false);\n    }\n\n    /**\n     * Gets the pixel color at the specified position\n     * @param {number} x\n     * @param {number} y\n     * @returns {Uint8ClampedArray} The RGBA value\n     */\n    getRGBAAt(x, y) {\n        this.__check_boundaries__(x, y);\n        const idx = ((~~y - 1) * this.width + (~~x - 1)) * 4;\n        return this.bitmap.subarray(idx, idx + 4);\n    }\n\n    /**\n     * Sets the pixel color for the specified position\n     * @param {number} x\n     * @param {number} y\n     * @param {number} pixelColor\n     */\n    setPixelAt(x, y, pixelColor) {\n        x = ~~x;\n        y = ~~y;\n        this.__check_boundaries__(x, y);\n        this.__set_pixel__(x, y, pixelColor);\n        return this;\n    }\n\n    /**\n     * @private\n     * @param {number} x\n     * @param {number} y\n     * @param {number} pixelColor\n     */\n    __set_pixel__(x, y, pixelColor) {\n        this.__view__.setUint32(((y - 1) * this.width + (x - 1)) * 4, pixelColor, false);\n    }\n\n    /**\n     * @private\n     * @param {number} x\n     * @param {number} y\n     */\n    __check_boundaries__(x, y) {\n        if (isNaN(x)) throw new TypeError(`Invalid pixel coordinates (x=${x})`);\n        if (isNaN(y)) throw new TypeError(`Invalid pixel coordinates (y=${y})`);\n        if (x < 1)\n            throw new RangeError(`${Image.__out_of_bounds__} (x=${x})<1`);\n        if (x > this.width)\n            throw new RangeError(`${Image.__out_of_bounds__} (x=${x})>(width=${this.width})`);\n        if (y < 1)\n            throw new RangeError(`${Image.__out_of_bounds__} (y=${y})<1`);\n        if (y > this.height)\n            throw new RangeError(`${Image.__out_of_bounds__} (y=${y})>(height=${this.height})`);\n    }\n\n    /**\n     * @private\n     */\n    static get __out_of_bounds__() {\n        return 'Tried referencing a pixel outside of the images boundaries:';\n    }\n\n    /**\n     * @callback colorFunction\n     * @param {number} x\n     * @param {number} y\n     * @returns {number} pixel color\n     */\n\n    /**\n     * Fills the image data with the supplied color\n     * @param {number|colorFunction} color\n     * @returns {Image}\n     */\n    fill(color) {\n        const type = typeof color;\n        if (type !== 'function') {\n            this.__view__.setUint32(0, color, false);\n            this.__u32__.fill(this.__u32__[0]);\n        } else {\n            let offset = 0;\n            for (let y = 1; y <= this.height; y++) {\n                for (let x = 1; x <= this.width; x++) {\n                    this.__view__.setUint32(offset, color(x, y), false);\n                    offset += 4;\n                }\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * Clones the current image\n     * @returns {Image}\n     */\n    clone() {\n        const image = new Image(this.width, this.height);\n        image.bitmap.set(this.bitmap);\n        return image;\n    }\n\n    /**\n     * Use {@link https://en.wikipedia.org/wiki/Image_scaling#Nearest-neighbor_interpolation Nearest-neighbor} resizing.\n     * @returns {string}\n     */\n    static get RESIZE_NEAREST_NEIGHBOR() {\n        return 'RESIZE_NEAREST_NEIGHBOR';\n    }\n\n    /**\n     * Used for automatically preserving an images aspect ratio when resizing.\n     * @returns {number}\n     */\n    static get RESIZE_AUTO() {\n        return -1;\n    }\n\n    /**\n     * Resizes the image by the given factor\n     * @param {number} factor The factor to resize the image with\n     * @param {string} [mode=Image.RESIZE_NEAREST_NEIGHBOR] The resizing mode to use\n     * @returns {Image}\n     */\n    scale(factor, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        const image = this.__scale__(factor, mode);\n        return this.__apply__(image);\n    }\n\n    /** @private */\n    __scale__(factor, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        if (factor === 1) return this;\n        return this.__resize__(this.width * factor, this.height * factor, mode);\n    }\n\n    /**\n     * Resizes the image to the given dimensions.\n     * Use {@link Image.RESIZE_AUTO} as either width or height to automatically preserve the aspect ratio.\n     * @param {number} width The new width\n     * @param {number} height The new height\n     * @param {string} [mode=Image.RESIZE_NEAREST_NEIGHBOR] The resizing mode to use\n     * @returns {Image} The resized image\n     */\n    resize(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        const image = this.__resize__(width, height, mode);\n        return this.__apply__(image);\n    }\n\n    /** @private */\n    __resize__(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        if (width === Image.RESIZE_AUTO && height === Image.RESIZE_AUTO) throw new Error('RESIZE_AUTO can only be used for either width or height, not for both');\n        else if (width === Image.RESIZE_AUTO) width = this.width / this.height * height;\n        else if (height === Image.RESIZE_AUTO) height = this.height / this.width * width;\n\n        width = Math.floor(width);\n        height = Math.floor(height);\n        if (width < 1)\n            throw new RangeError('Image has to be at least 1 pixel wide');\n        if (height < 1)\n            throw new RangeError('Image has to be at least 1 pixel high');\n\n        let image;\n        if (mode === Image.RESIZE_NEAREST_NEIGHBOR)\n            image = this.__resize_nearest_neighbor__(width, height);\n        else throw new Error('Invalid resize mode');\n\n        return image;\n    }\n\n    /**\n     * @private\n     * @param {number} width The new width\n     * @param {number} height The new height\n     */\n    __resize_nearest_neighbor__(width, height) {\n        const image = new this.constructor(width, height);\n\n        for (let y = 0; y < height; y++) {\n            for (let x = 0; x < width; x++) {\n                const ySrc = Math.floor((y * this.height) / height);\n                const xSrc = Math.floor((x * this.width) / width);\n\n                const destPos = (y * width + x) * 4;\n                const srcPos = (ySrc * this.width + xSrc) * 4;\n\n                image.__view__.setUint32(destPos, this.__view__.getUint32(srcPos, false), false);\n            }\n        }\n\n        return image;\n    }\n\n    /**\n     * Crops an image to the specified dimensions\n     * @param {number} x The x offset\n     * @param {number} y The y offset\n     * @param {number} width The new images width\n     * @param {number} height The new images height\n     * @returns {Image}\n     */\n    crop(x, y, width, height) {\n        if (width > this.width) width = this.width;\n        if (height > this.height) height = this.height;\n\n        return this.__apply__(this.__crop__(~~x, ~~y, ~~width, ~~height));\n    }\n\n    /**\n     * @param {number} x\n     * @param {number} y\n     * @param {number} width\n     * @param {number} height\n     * @returns {Image}\n     * @private\n     */\n    __crop__(x, y, width, height) {\n        x = ~~x;\n        y = ~~y;\n\n        const image = new this.constructor(width, height);\n\n        for (let tY = 0; tY < height; tY++) {\n            const idx = (tY + y) * this.width + x;\n            image.__u32__.set(this.__u32__.subarray(idx, idx + width), tY * width);\n        }\n\n        return image;\n    }\n\n    /**\n     * Draws a box at the specified coordinates\n     * @param {number} x The x offset\n     * @param {number} y The y offset\n     * @param {number} width The box width\n     * @param {number} height The box height\n     * @param {number|colorFunction} color The color to fill the box in with\n     * @returns {Image}\n     */\n    drawBox(x, y, width, height, color) {\n        x = ~~(x - 1);\n        y = ~~(y - 1);\n        width = ~~width;\n        height = ~~height;\n\n        if (typeof color === 'function') {\n            for (let tY = 1; tY <= height; tY++) {\n                for (let tX = 1; tX <= width; tX++) {\n                    const nX = tX + x;\n                    const nY = tY + y;\n                    if (Math.min(nX, nY) < 1 || nX > this.width || nY > this.height)\n                        continue;\n\n                    const tC = color(tX, tY);\n                    this.__set_pixel__(nX, nY, tC);\n                }\n            }\n        } else return this.__fast_box__(x, y, width, height, color);\n\n        return this;\n    }\n\n    /**\n     * @private\n     * @param {number} x\n     * @param {number} y\n     * @param {number} width\n     * @param {number} height\n     * @param {number} color\n     */\n    __fast_box__(x, y, width, height, color) {\n        if (x < 0) {\n            width += x;\n            x = 1;\n        }\n\n        if (y < 0) {\n            height += y;\n            y = 1;\n        }\n\n        const right = Math.max(Math.min(x + width, this.width), 1);\n        let xPos = right;\n        while (x <= --xPos)\n            this.__view__.setUint32(4 * (xPos + y * this.width), color);\n        const end = 4 * (right + y * this.width);\n        const start = 4 * (x + y * this.width);\n\n        let bottom = Math.max(Math.min(y + height, this.height), 1);\n        while (y < --bottom)\n            this.bitmap.copyWithin(4 * (x + bottom * this.width), start, end);\n\n        return this;\n    }\n\n    /**\n     * Draws a circle at the specified coordinates with the specified radius\n     * @param {number} x The center x position\n     * @param {number} y The center y position\n     * @param {number} radius The circles radius\n     * @param {number|colorFunction} color\n     * @returns {Image}\n     */\n    drawCircle(x, y, radius, color) {\n        const radSquared = radius ** 2;\n        for (let currentY = Math.max(1, y - radius); currentY <= Math.min(y + radius, this.height); currentY++) {\n            for (let currentX = Math.max(1, x - radius); currentX <= Math.min(x + radius, this.width); currentX++) {\n                if ((currentX - x) ** 2 + (currentY - y) ** 2 < radSquared)\n                    this.__set_pixel__(currentX, currentY, typeof color === 'function' ? color(currentX - x + radius, currentY - y + radius) : color);\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * Crops the image into a circle\n     * @param {boolean} [max=false] Whether to use the larger dimension for the size\n     * @param {number} [feathering=0] How much feathering to apply to the edges\n     * @returns {Image}\n     */\n    cropCircle(max = false, feathering = 0) {\n        const rad = Math[max ? 'max' : 'min'](this.width, this.height) / 2;\n        const radSquared = rad ** 2;\n        const centerX = this.width / 2;\n        const centerY = this.height / 2;\n\n        for (const [x, y] of this) {\n            const distanceFromCenter = (x - centerX) ** 2 + (y - centerY) ** 2;\n            const alphaIdx = ((y - 1) * this.width + (x - 1)) * 4 + 3;\n            if (distanceFromCenter > radSquared)\n                this.bitmap[alphaIdx] = 0;\n            else if (feathering)\n                this.bitmap[alphaIdx] *= Math.max(0, Math.min(1, 1 - (distanceFromCenter / radSquared) * feathering ** (1 / 2)));\n        }\n\n        return this;\n    }\n\n    /**\n     * Sets the images opacity\n     * @param {number} opacity The opacity to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current opacity (false) or just set the new opacity (true)\n     * @returns {Image}\n     */\n    opacity(opacity, absolute = false) {\n        if (isNaN(opacity) || opacity < 0)\n            throw new RangeError('Invalid opacity value');\n\n        this.__set_channel_value__(opacity, absolute, 3);\n\n        return this;\n    }\n\n    /**\n     * Sets the red channels saturation\n     * @param {number} saturation The saturation to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current saturation (false) or just set the new saturation (true)\n     * @returns {Image}\n     */\n    red(saturation, absolute = false) {\n        if (isNaN(saturation) || saturation < 0)\n            throw new RangeError('Invalid saturation value');\n\n        this.__set_channel_value__(saturation, absolute, 0);\n\n        return this;\n    }\n\n    /**\n     * Sets the green channels saturation\n     * @param {number} saturation The saturation to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current saturation (false) or just set the new saturation (true)\n     * @returns {Image}\n     */\n    green(saturation, absolute = false) {\n        if (isNaN(saturation) || saturation < 0)\n            throw new RangeError('Invalid saturation value');\n\n        this.__set_channel_value__(saturation, absolute, 1);\n\n        return this;\n    }\n\n    /**\n     * Sets the blue channels saturation\n     * @param {number} saturation The saturation to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current saturation (false) or just set the new saturation (true)\n     * @returns {Image}\n     */\n    blue(saturation, absolute = false) {\n        if (isNaN(saturation) || saturation < 0)\n            throw new RangeError('Invalid saturation value');\n\n        this.__set_channel_value__(saturation, absolute, 2);\n\n        return this;\n    }\n\n    /**\n     * @private\n     * @param {number} value\n     * @param {boolean} absolute\n     * @param {number} offset\n     */\n    __set_channel_value__(value, absolute, offset) {\n        for (let i = offset; i < this.bitmap.length; i += 4)\n            this.bitmap[i] = value * (absolute ? 255 : this.bitmap[i]);\n    }\n\n    /**\n     * Sets the brightness of the image\n     * @param {number} value The lightness to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current lightness (false) or just set the new lightness (true)\n     * @returns {Image}\n     */\n    lightness(value, absolute = false) {\n        if (isNaN(value) || value < 0)\n            throw new RangeError('Invalid lightness value');\n\n        return this.fill((x, y) => {\n            const [h, s, l, a] = Image.rgbaToHSLA(...this.getRGBAAt(x, y));\n            return Image.hslaToColor(h, s, value * (absolute ? 1 : l), a);\n        });\n    }\n\n    /**\n     * Sets the saturation of the image\n     * @param {number} value The saturation to apply (0..1)\n     * @param {boolean} absolute Whether to scale the current saturation (false) or just set the new saturation (true)\n     * @returns {Image}\n     */\n    saturation(value, absolute = false) {\n        if (isNaN(value) || value < 0)\n            throw new RangeError('Invalid saturation value');\n\n        return this.fill((x, y) => {\n            const [h, s, l, a] = Image.rgbaToHSLA(...this.getRGBAAt(x, y));\n            return Image.hslaToColor(h, value * (absolute ? 1 : s), l, a);\n        });\n    }\n\n    /**\n     * Composites (overlays) the source onto this image at the specified coordinates\n     * @param {Image} source The image to place\n     * @param {number} [x=0] The x position to place the image at\n     * @param {number} [y=0] The y position to place the image at\n     * @returns {Image}\n     */\n    composite(source, x = 0, y = 0) {\n        x = ~~x;\n        y = ~~y;\n\n        for (let yy = 0; yy < source.height; yy++) {\n            let y_offset = y + yy;\n            if (y_offset < 0) continue;\n            if (y_offset >= this.height) break;\n\n            for (let xx = 0; xx < source.width; xx++) {\n                let x_offset = x + xx;\n                if (x_offset < 0) continue;\n                if (x_offset >= this.width) break;\n\n                const offset = 4 * (x_offset + y_offset * this.width);\n                const fg = source.__view__.getUint32(4 * (xx + yy * source.width), false);\n                const bg = this.__view__.getUint32(offset, false);\n\n                if ((fg & 0xff) === 0xff) this.__view__.setUint32(offset, fg, false);\n                else if ((fg & 0xff) === 0x00) this.__view__.setUint32(offset, bg, false);\n                else this.__view__.setUint32(offset, Image.__alpha_blend__(fg, bg), false);\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * @private\n     * @param {number} fg\n     * @param {number} bg\n     * @returns {number}\n     */\n    static __alpha_blend__(fg, bg) {\n        const fa = fg & 0xff;\n        const alpha = fa + 1;\n        const inv_alpha = 256 - fa;\n        const r = (alpha * (fg >>> 24) + inv_alpha * (bg >>> 24)) >> 8;\n        const b = (alpha * (fg >> 8 & 0xff) + inv_alpha * (bg >> 8 & 0xff)) >> 8;\n        const g = (alpha * (fg >> 16 & 0xff) + inv_alpha * (bg >> 16 & 0xff)) >> 8;\n        return (((r & 0xff) << 24) | ((g & 0xff) << 16) | ((b & 0xff) << 8) | (Math.max(fa, bg & 0xff) & 0xff));\n    }\n\n    /**\n     * Inverts the images colors\n     * @returns {Image}\n     */\n    invert() {\n        for (const [x, y, color] of this.iterateWithColors())\n            this.__set_pixel__(x, y, ((0xffffffff - color) & 0xffffff00) | (color & 0xff));\n\n        return this;\n    }\n\n    /**\n     * Inverts the images value (lightness)\n     * @returns {Image}\n     */\n    invertValue() {\n        for (const [x, y, color] of this.iterateWithColors()) {\n            const [h, s, l, a] = Image.rgbaToHSLA(...Image.colorToRGBA(color));\n            this.__set_pixel__(x, y, Image.hslaToColor(h, s, 1 - l, a));\n        }\n\n        return this;\n    }\n\n    /**\n     * Inverts the images saturation\n     * @returns {Image}\n     */\n    invertSaturation() {\n        for (const [x, y, color] of this.iterateWithColors()) {\n            const [h, s, l, a] = Image.rgbaToHSLA(...Image.colorToRGBA(color));\n            this.__set_pixel__(x, y, Image.hslaToColor(h, 1 - s, l, a));\n        }\n\n        return this;\n    }\n\n    /**\n     * Inverts the images hue\n     * @returns {Image}\n     */\n    invertHue() {\n        for (const [x, y, color] of this.iterateWithColors()) {\n            const [h, s, l, a] = Image.rgbaToHSLA(...Image.colorToRGBA(color));\n            this.__set_pixel__(x, y, Image.hslaToColor(1 - h, s, l, a));\n        }\n\n        return this;\n    }\n\n    /**\n     * Shifts the images hue\n     * @param {number} degrees How many degrees to shift the hue by\n     */\n    hueShift(degrees) {\n        for (const [x, y, color] of this.iterateWithColors()) {\n            const [h, s, l, a] = Image.rgbaToHSLA(...Image.colorToRGBA(color));\n            this.__set_pixel__(x, y, Image.hslaToColor(h + degrees / 360, s, l, a));\n        }\n\n        return this;\n    }\n\n    /**\n     * Gets the average color of the image\n     * @returns {number}\n     */\n    averageColor() {\n        let colorAvg = [0, 0, 0];\n        let divisor = 0;\n        for (let idx = 0; idx < this.bitmap.length; idx += 4) {\n            const rgba = this.bitmap.subarray(idx, idx + 4);\n            for (let i = 0; i < 3; i++)\n                colorAvg[i] += rgba[i];\n            divisor += rgba[3] / 255;\n        }\n\n        return Image.rgbaToColor(...colorAvg.map(v => v / divisor), 0xff);\n    }\n\n    /**\n     * Gets the images dominant color\n     * @param {boolean} [ignoreBlack=true] Whether to ignore dark colors below the threshold\n     * @param {boolean} [ignoreWhite=true] Whether to ignore light colors above the threshold\n     * @param {number} [bwThreshold=0xf] The black/white threshold (0-64)\n     * @return {number} The images dominant color\n     */\n    dominantColor(ignoreBlack = true, ignoreWhite = true, bwThreshold = 0xf) {\n        const colorCounts = new Array(0x3ffff);\n        for (let i = 0; i < this.bitmap.length; i += 4) {\n            const color = this.__view__.getUint32(i, false);\n            const [h, s, l] = Image.rgbaToHSLA(...Image.colorToRGBA(color)).map(v => (~~(v * 0x3f)));\n            if (ignoreBlack && l < bwThreshold) continue;\n            if (ignoreWhite && l > 0x3f - bwThreshold) continue;\n            const key = h << 12 | s << 6 | l;\n            colorCounts[key] = (colorCounts[key] || 0) + 1;\n        }\n\n        let maxColorCount = -1;\n        let mostProminentValue = 0;\n        colorCounts.forEach((el, i) => {\n            if (el < maxColorCount) return;\n            maxColorCount = el;\n            mostProminentValue = i;\n        });\n\n        if (mostProminentValue === -1)\n            return this.dominantColor(ignoreBlack, ignoreWhite, bwThreshold - 1);\n\n        const h = (mostProminentValue >>> 12) & 0x3f;\n        const s = (mostProminentValue >>> 6) & 0x3f;\n        const l = mostProminentValue & 0x3f;\n\n        return Image.hslaToColor(h / 0x3f, s / 0x3f, l / 0x3f, 1);\n    }\n\n    /**\n     * Rotates the image the given amount of degrees\n     * @param {number} angle The angle to rotate the image for (in degrees)\n     * @param {boolean} resize Whether to resize the image so it fits all pixels or just ignore outlying pixels\n     */\n    rotate(angle, resize = true) {\n        if (angle % 360 === 0) return this;\n        if (angle % 180 === 0) return this.__rotate_180__();\n\n        const rad = Math.PI * (angle / 180);\n\n        const sin = Math.sin(rad);\n        const cos = Math.cos(rad);\n\n        const width = resize\n            ? Math.abs(this.width * sin) + Math.abs(this.height * cos)\n            : this.width;\n        const height = resize\n            ? Math.abs(this.width * cos) + Math.abs(this.height * sin)\n            : this.height;\n\n        const out = new Image(width, height);\n\n        const out_cx = width / 2 - .5;\n        const out_cy = height / 2 - .5;\n        const src_cx = this.width / 2 - .5;\n        const src_cy = this.height / 2 - .5;\n\n        let h = 0;\n        do {\n            let w = 0;\n            const ysin = src_cx - sin * (h - out_cy);\n            const ycos = src_cy + cos * (h - out_cy);\n\n            do {\n                const xf = ysin + cos * (w - out_cx);\n                const yf = ycos + sin * (w - out_cx);\n                Image.__interpolate__(this, out, w, h, xf, yf);\n            } while (w++ < width);\n        } while (h++ < height);\n\n        return this.__apply__(out);\n    }\n\n    /**\n     * @returns {Image}\n     * @private\n     */\n    __rotate_180__() {\n        let offset = 0;\n        this.bitmap.reverse();\n        while (offset < this.bitmap.length) this.bitmap.subarray(offset, offset += 4).reverse();\n\n        return this;\n    }\n\n    /**\n     * @param {Image} src\n     * @param {Image} out\n     * @param {number} x0\n     * @param {number} y0\n     * @param {number} x1\n     * @param {number} y1\n     * @private\n     */\n    static __interpolate__(src, out, x0, y0, x1, y1) {\n        const x2 = ~~x1;\n        const y2 = ~~y1;\n        const xq = x1 - x2;\n        const yq = y1 - y2;\n        const out_slice = out.bitmap.subarray(4 * (x0 + y0 * out.width), -4);\n\n        const ref = {\n            r: 0,\n            g: 0,\n            b: 0,\n            a: 0,\n        };\n\n        Image.__pawn__(x2, y2, (1 - xq) * (1 - yq), ref, src);\n        Image.__pawn__(1 + x2, y2, xq * (1 - yq), ref, src);\n        Image.__pawn__(x2, 1 + y2, (1 - xq) * yq, ref, src);\n        Image.__pawn__(1 + x2, 1 + y2, xq * yq, ref, src);\n\n        out_slice[3] = ref.a;\n        out_slice[0] = ref.r / ref.a;\n        out_slice[1] = ref.g / ref.a;\n        out_slice[2] = ref.b / ref.a;\n    }\n\n    /** @private */\n    static __pawn__(point0, point1, weight, ref, src) {\n        if (\n            point0 > 0\n            && point1 > 0\n            && point0 < src.width\n            && point1 < src.height\n        ) {\n            const offset = 4 * (point0 + point1 * src.width);\n            const src_slice = src.bitmap.subarray(offset, offset + 4);\n\n            const wa = weight * src_slice[3];\n\n            ref.a += wa;\n            ref.r += wa * src_slice[0];\n            ref.g += wa * src_slice[1];\n            ref.b += wa * src_slice[2];\n        }\n    }\n\n    /**\n     * @private\n     * @param {Image|Frame} image\n     * @returns {Image|Frame}\n     */\n    __apply__(image) {\n        this.__width__ = image.__width__;\n        this.__height__ = image.__height__;\n        this.__view__ = image.__view__;\n        this.__u32__ = image.__u32__;\n        this.bitmap = image.bitmap;\n\n        if (image instanceof Frame)\n            return Frame.from(this, image.duration, image.xOffset, image.yOffset, image.disposalMode);\n\n        return this;\n    }\n\n    /**\n     * Creates a multi-point gradient generator\n     * @param {Object<number, number>} colors The gradient points to use (e.g. `{0: 0xff0000ff, 1: 0x00ff00ff}`)\n     * @return {(function(number): number)} The gradient generator. The function argument is the position in the gradient (0..1).\n     */\n    static gradient(colors) {\n        const entries = Object.entries(colors).sort((a, b) => a[0] - b[0]);\n        const positions = entries.map(e => parseFloat(e[0]));\n        const values = entries.map(e => e[1]);\n\n        if (positions.length === 0) throw new RangeError('Invalid gradient point count');\n        else if (positions.length === 1) {\n            return () => values[0];\n        } else if (positions.length === 2) {\n            const gradient = this.__gradient__(values[0], values[1]);\n            return position => {\n                if (position <= positions[0]) return values[0];\n                if (position >= positions[1]) return values[1];\n                return gradient((position - positions[0]) / (positions[1] - positions[0]));\n            };\n        }\n\n        const minDef = Math.min(...positions);\n        const maxDef = Math.max(...positions);\n        let gradients = [];\n\n        for (let i = 0; i < positions.length; i++) {\n            let minPos = positions[i - 1];\n            if (minPos === undefined) continue;\n\n            let maxPos = positions[i];\n\n            let minVal = values[i - 1];\n            if (minVal === undefined) minVal = values[i];\n\n            const maxVal = values[i];\n            const gradient = this.__gradient__(minVal, maxVal);\n\n            gradients.push({min: minPos, max: maxPos, gradient});\n        }\n\n        return position => {\n            if (position <= minDef) return gradients[0].gradient(0);\n            if (position >= maxDef) return gradients[gradients.length - 1].gradient(1);\n\n            for (const gradient of gradients)\n                if (position >= gradient.min && position <= gradient.max)\n                    return gradient.gradient((position - gradient.min) / (gradient.max - gradient.min));\n            throw new RangeError(`Invalid gradient position: ${position}`);\n        };\n    }\n\n    /**\n     * Rounds the images corners\n     * @param {number} [radius=min(width,height)/4] The radius of the corners\n     * @return {Image}\n     */\n    roundCorners(radius = Math.min(this.width, this.height) / 4) {\n        const radSquared = radius ** 2;\n        for (let x = 1; x <= radius; x++) {\n            const xRad = (x - radius) ** 2;\n            for (let y = 1; y <= radius; y++) {\n                if (xRad + (y - radius) ** 2 > radSquared)\n                    this.bitmap[((y - 1) * this.width + x - 1) * 4 + 3] = 0;\n            }\n        }\n\n        for (let x = 1; x <= radius; x++) {\n            const xRad = (x - radius) ** 2;\n            for (let y = this.height - radius; y <= this.height; y++) {\n                if (xRad + ((this.height - y) - radius) ** 2 > radSquared)\n                    this.bitmap[((y - 1) * this.width + x - 1) * 4 + 3] = 0;\n            }\n        }\n\n        for (let x = this.width - radius; x <= this.width; x++) {\n            const xRad = ((this.width - x) - radius) ** 2;\n            for (let y = 1; y <= radius; y++) {\n                if (xRad + (y - radius) ** 2 > radSquared)\n                    this.bitmap[((y - 1) * this.width + x - 1) * 4 + 3] = 0;\n            }\n        }\n\n        for (let x = this.width - radius; x <= this.width; x++) {\n            const xRad = ((this.width - x) - radius) ** 2;\n            for (let y = this.height - radius; y <= this.height; y++) {\n                if (xRad + ((this.height - y) - radius) ** 2 > radSquared)\n                    this.bitmap[((y - 1) * this.width + x - 1) * 4 + 3] = 0;\n            }\n        }\n\n        return this;\n    }\n\n    /**\n     * @private\n     */\n    static __gradient__(startColor, endColor) {\n        const sr = startColor >>> 24;\n        const sg = startColor >> 16 & 0xff;\n        const sb = startColor >> 8 & 0xff;\n        const sa = startColor & 0xff;\n        const er = (endColor >>> 24) - sr;\n        const eg = (endColor >> 16 & 0xff) - sg;\n        const eb = (endColor >> 8 & 0xff) - sb;\n        const ea = (endColor & 0xff) - sa;\n\n        return position => {\n            const r = sr + position * er;\n            const g = sg + position * eg;\n            const b = sb + position * eb;\n            const a = sa + position * ea;\n            return (((r & 0xff) << 24) | ((g & 0xff) << 16) | ((b & 0xff) << 8) | (a & 0xff));\n        };\n    }\n\n    fisheye(radius = 2) {\n        const r = new Image(this.width, this.height);\n\n        const w = this.width;\n        const h = this.height;\n        const tu32 = this.__u32__;\n        const ru32 = r.__u32__;\n        const iw = 1 / w;\n        const ih = 1 / h;\n\n        for (const [x, y] of this) {\n            const xco = x * iw - .5;\n            const yco = y * ih - .5;\n            const dfc = Math.sqrt(xco ** 2 + yco ** 2);\n            const dis = 2 * dfc ** radius;\n            const nx = ((dis * xco / dfc + 0.5) * w) | 0;\n            const ny = ((dis * yco / dfc + 0.5) * h) | 0;\n\n            if (nx < 1 || nx > w || ny < 1 || ny > h || isNaN(nx) || isNaN(ny))\n                continue;\n\n            ru32[y * w + x] = tu32[w * ny + nx];\n        }\n\n        const cO = tu32.length * .5 + w / 2;\n        ru32[cO] = tu32[cO];\n\n        return this.__apply__(r);\n    }\n\n    /**\n     * @typedef {object} PNGMetadata\n     * @property {string} [title] The images title\n     * @property {string} [author] The images author\n     * @property {string} [description] The images description\n     * @property {string} [copyright] The images copyright info\n     * @property {string|number|Date} [creationTime=Date.now()] The images creation timestamp\n     * @property {string} [software=\"github.com/matmen/ImageScript vX.X.X\"] The software used to create this image\n     * @property {string} [disclaimer] A disclaimer for the image\n     * @property {string} [warning] A warning for the image\n     * @property {string} [source] The images source\n     * @property {string} [comment] A comment for the image\n     */\n\n    /**\n     * Encodes the image into a PNG\n     * @param {number} compression The compression level to use (0-9)\n     * @param {PNGMetadata} [meta={}] Image metadata\n     * @return {Promise<Uint8Array>} The encoded data\n     */\n    async encode(compression = 1, {\n        title,\n        author,\n        description,\n        copyright,\n        creationTime,\n        software,\n        disclaimer,\n        warning,\n        source,\n        comment\n    } = {}) {\n        return png.encode(this.bitmap, {\n            width: this.width,\n            height: this.height,\n            level: compression,\n            channels: 4,\n            text: {\n                Title: title,\n                Author: author,\n                Description: description,\n                Copyright: copyright,\n                'Creation Time': new Date(creationTime === undefined ? Date.now() : creationTime).toUTCString(),\n                Software: software === undefined ? `github.com/matmen/ImageScript v${version}` : software,\n                Disclaimer: disclaimer,\n                Warning: warning,\n                Source: source,\n                Comment: comment\n            }\n        });\n    }\n\n    /**\n     * Encodes the image into a JPEG\n     * @param {number} [quality=90] The JPEG quality to use (1-100)\n     * @return {Promise<Uint8Array>}\n     */\n    async encodeJPEG(quality = 90) {\n        return (await jpeglib.init()).encode(this.bitmap, this.width, this.height, quality);\n    }\n\n    /**\n     * Decodes an image (PNG, JPEG or TIFF)\n     * @param {Buffer|Uint8Array} data The binary data to decode\n     * @return {Promise<Image>} The decoded image\n     */\n    static async decode(data) {\n        let image;\n\n        data = mem.view(data);\n        const view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n\n        if (ImageType.isPNG(view)) { // PNG\n            const {width, height, pixels} = png.decode(data);\n            image = new Image(width, height);\n            image.bitmap.set(pixels);\n        } else if (ImageType.isJPEG(view)) { // JPEG\n            const framebuffer = (await jpeglib.init()).decode(data);\n\n            const width = framebuffer.width;\n            const height = framebuffer.height;\n            const pixelType = framebuffer.format;\n\n            image = new Image(width, height);\n            const buffer = framebuffer.buffer;\n\n            if (pixelType === 0) {\n                const view = new DataView(image.bitmap.buffer);\n\n                for (let i = 0; i < buffer.length; i++) {\n                    const pixel = buffer[i];\n                    view.setUint32(i * 4, pixel << 24 | pixel << 16 | pixel << 8 | 0xff, false);\n                }\n            } else if (pixelType === 1) {\n                image.bitmap.fill(0xff);\n                for (let i = 0; i < width * height; i++)\n                    image.bitmap.set(buffer.subarray(i * 3, i * 3 + 3), i * 4);\n            } else if (pixelType === 2) {\n                for (let i = 0; i < buffer.length; i += 4) {\n                    image.bitmap[i] = 0xff * (1 - buffer[i] / 0xff) * (1 - buffer[i + 3] / 0xff);\n                    image.bitmap[i + 1] = 0xff * (1 - buffer[i + 1] / 0xff) * (1 - buffer[i + 3] / 0xff);\n                    image.bitmap[i + 2] = 0xff * (1 - buffer[i + 2] / 0xff) * (1 - buffer[i + 3] / 0xff);\n                    image.bitmap[i + 3] = 0xff;\n                }\n            }\n        } else if (ImageType.isTIFF(view)) { // TIFF\n            const framebuffer = (await tifflib.init()).decode(data);\n            image = new Image(framebuffer.width, framebuffer.height);\n\n            image.bitmap.set(framebuffer.buffer);\n        } else throw new Error('Unsupported image type');\n\n        return image;\n    }\n\n    /**\n     * Scale the SVG by the given amount. For use with {@link Image.renderSVG}\n     * @return {number}\n     */\n    static get SVG_MODE_SCALE() {\n        return 1;\n    }\n\n    /**\n     * Scale the SVG to fit the given width. For use with {@link Image.renderSVG}\n     * @return {number}\n     */\n    static get SVG_MODE_WIDTH() {\n        return 2;\n    }\n\n    /**\n     * Scale the SVG to fit the given height. For use with {@link Image.renderSVG}\n     * @return {number}\n     */\n    static get SVG_MODE_HEIGHT() {\n        return 3;\n    }\n\n    /**\n     * Creates a new image from the given SVG\n     * @param {string} svg The SVG content\n     * @param {number} size The size to use\n     * @param {number} mode The SVG resizing mode to use (one of {@link SVG_MODE_SCALE}, {@link SVG_MODE_WIDTH}, {@link SVG_MODE_HEIGHT})\n     * @return {Promise<Image>} The rendered SVG graphic\n     */\n    static async renderSVG(svg, size = 1, mode = this.SVG_MODE_SCALE) {\n        if (![this.SVG_MODE_WIDTH, this.SVG_MODE_HEIGHT, this.SVG_MODE_SCALE].includes(mode))\n            throw new Error('Invalid SVG scaling mode');\n\n        if (mode === this.SVG_MODE_SCALE && size <= 0)\n            throw new RangeError('SVG scale must be > 0');\n        if (mode !== this.SVG_MODE_SCALE && size < 1)\n            throw new RangeError('SVG size must be >= 1')\n\n        if (typeof svg === 'string') svg = new TextEncoder().encode(svg);\n        const framebuffer = (await svglib.init()).rasterize(svg, mode, size);\n\n        const image = new Image(framebuffer.width, framebuffer.height);\n\n        image.bitmap.set(framebuffer.buffer);\n\n        return image;\n    }\n\n    /**\n     * Creates a new image containing the rendered text.\n     * @param {Uint8Array} font TrueType (ttf/ttc) or OpenType (otf) font buffer to use\n     * @param {number} scale Font size to use\n     * @param {string} text Text to render\n     * @param {number} [color=0xffffffff] Text color to use\n     * @param {TextLayout} [layout] The text layout to use\n     * @return {Promise<Image>} The rendered text\n     */\n    static async renderText(font, scale, text, color = 0xffffffff, layout = new TextLayout()) {\n        const { Font, Layout } = await fontlib.init();\n\n        font = new Font(scale, font);\n        const [r, g, b, a] = Image.colorToRGBA(color);\n\n        const layoutOptions = new Layout();\n\n        layoutOptions.reset({\n            max_width: layout.maxWidth,\n            max_height: layout.maxHeight,\n            wrap_style: layout.wrapStyle,\n            vertical_align: layout.verticalAlign,\n            horizontal_align: layout.horizontalAlign,\n            wrap_hard_breaks: layout.wrapHardBreaks\n        });\n\n        layoutOptions.append(font, text, {scale});\n        const framebuffer = layoutOptions.rasterize(r, g, b);\n        const image = new Image(framebuffer.width, framebuffer.height);\n\n        image.bitmap.set(framebuffer.buffer);\n\n        if (image.height > layout.maxHeight)\n            image.crop(0, 0, image.width, Math.floor(layoutOptions.lines() / image.height * layout.maxHeight) * (image.height / layoutOptions.lines()));\n\n        font.free();\n        layoutOptions.free();\n        return image.opacity(a / 0xff);\n    }\n\n}\n\n/**\n * Represents a frame in a GIF\n * @extends Image\n */\n class Frame extends Image {\n    /**\n     * GIF frame disposal mode KEEP. For use with {@link Frame}\n     * @returns {string}\n     */\n    static get DISPOSAL_KEEP() {\n        return 'keep';\n    }\n\n    /**\n     * GIF frame disposal mode PREVIOUS. For use with {@link Frame}\n     * @returns {string}\n     */\n    static get DISPOSAL_PREVIOUS() {\n        return 'previous';\n    }\n\n    /**\n     * GIF frame disposal mode BACKGROUND. For use with {@link Frame}\n     * @returns {string}\n     */\n    static get DISPOSAL_BACKGROUND() {\n        return 'background';\n    }\n\n    static __convert_disposal_mode__(mode) {\n        if (typeof mode === 'string')\n            mode = ['any', 'keep', 'previous', 'background'].indexOf(mode);\n        if (mode < 0 || mode > 3)\n            throw new RangeError('Invalid disposal mode');\n\n        return mode;\n    }\n\n    /**\n     * Creates a new, blank frame\n     * @param {number} width\n     * @param {number} height\n     * @param {number} [duration = 100] The frames duration (in ms)\n     * @param {number} [xOffset=0] The frames offset on the x-axis\n     * @param {number} [yOffset=0] The frames offset on the y-axis\n     * @param {string|number} [disposalMode=Frame.DISPOSAL_KEEP] The frame's disposal mode ({@link Frame.DISPOSAL_KEEP}, {@link Frame.DISPOSAL_PREVIOUS} or {@link Frame.DISPOSAL_BACKGROUND})\n     * @return {Frame}\n     */\n    constructor(width, height, duration = 100, xOffset = 0, yOffset = 0, disposalMode = Frame.DISPOSAL_KEEP) {\n        if (isNaN(duration) || duration < 0)\n            throw new RangeError('Invalid frame duration');\n\n        disposalMode = Frame.__convert_disposal_mode__(disposalMode);\n\n        super(width, height);\n        this.duration = duration;\n        this.xOffset = xOffset;\n        this.yOffset = yOffset;\n        this.disposalMode = disposalMode;\n    }\n\n    toString() {\n        return `Frame<${this.width}x${this.height}x${this.duration}ms>`;\n    }\n\n    /**\n     * Converts an Image instance to a Frame, cloning it in the process\n     * @param {Image} image The image to create the frame from\n     * @param {number} [duration = 100] The frames duration (in ms)\n     * @param {number} [xOffset=0] The frames offset on the x-axis\n     * @param {number} [yOffset=0] The frames offset on the y-axis\n     * @param {string|number} [disposalMode=Frame.DISPOSAL_KEEP] The frames disposal mode ({@link Frame.DISPOSAL_KEEP}, {@link Frame.DISPOSAL_PREVIOUS} or {@link Frame.DISPOSAL_BACKGROUND})\n     * @return {Frame}\n     */\n    static from(image, duration, xOffset, yOffset, disposalMode = Frame.DISPOSAL_KEEP) {\n        if (!(image instanceof Image))\n            throw new TypeError('Invalid image passed');\n\n        disposalMode = Frame.__convert_disposal_mode__(disposalMode);\n\n        const frame = new Frame(image.width, image.height, duration, xOffset, yOffset, disposalMode);\n        frame.bitmap.set(image.bitmap);\n\n        return frame;\n    }\n\n    resize(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        const originalWidth = this.width;\n        const originalHeight = this.height;\n\n        const result = super.resize(width, height, mode);\n\n        this.xOffset *= result.width / originalWidth;\n        this.yOffset *= result.height / originalHeight;\n\n        return result;\n    }\n}\n\n/**\n * Represents a GIF image as an array of frames\n * @extends Array<Frame>\n */\nclass GIF extends Array {\n    /**\n     * Creates a new GIF image.\n     * @param {Frame[]} frames The frames to create the GIF from\n     * @param {number} [loopCount=0] How often to loop the GIF for (-1 = unlimited)\n     * @property {number} loopCount How often the GIF will loop for\n     */\n    constructor(frames, loopCount = -1) {\n        super(...frames);\n\n        for (const frame of this)\n            if (!(frame instanceof Frame))\n                throw new TypeError(`Frame ${this.indexOf(frame)} is not an instance of Frame`);\n\n        if (loopCount < -1 || isNaN(loopCount))\n            throw new RangeError('Invalid loop count');\n\n        this.loopCount = loopCount;\n    }\n\n    /**\n     * The GIFs width\n     * @returns {number}\n     */\n    get width() {\n        let max = 0;\n        for (const frame of this) {\n            let width = frame.width + frame.xOffset;\n            if (max < width)\n                max = width;\n        }\n\n        return max;\n    }\n\n    /**\n     * The GIFs height\n     * @returns {number}\n     */\n    get height() {\n        let max = 0;\n        for (const frame of this) {\n            let height = frame.height + frame.yOffset;\n            if (max < height)\n                max = height;\n        }\n\n        return max;\n    }\n\n    toString() {\n        return `GIF<${this.width}x${this.height}x${this.duration}ms>`;\n    }\n\n    /**\n     * @returns {Generator<Frame, void, *>}\n     */\n    * [Symbol.iterator]() {\n        for (let i = 0; i < this.length; i++)\n            yield this[i];\n    }\n\n    /**\n     * The GIFs duration (in ms)\n     * @return {number}\n     */\n    get duration() {\n        return this.reduce((acc, frame) => acc + frame.duration, 0);\n    }\n\n    /**\n     * Encodes the image into a GIF\n     * @param {number} [quality=95] GIF quality 0-100\n     * @return {Promise<Uint8Array>} The encoded data\n     */\n    async encode(quality = 95) {\n        const encoder = new (await giflib.init()).Encoder(this.width, this.height, this.loopCount);\n\n        for (const frame of this) {\n            if (!(frame instanceof Frame)) throw new Error('GIF contains invalid frames');\n            encoder.add(frame.xOffset, frame.yOffset, ~~(frame.duration / 10), frame.width, frame.height, frame.bitmap, frame.disposalMode, quality / 100 * 29 + 1);\n        }\n\n        return encoder.u8();\n    }\n\n    /**\n     * Decodes a GIF image\n     * @param {Buffer|Uint8Array} data The binary data to decode\n     * @param {boolean} [onlyExtractFirstFrame=false] Whether to end GIF decoding after the first frame\n     * @return {Promise<GIF>} The decoded GIF\n     */\n    static async decode(data, onlyExtractFirstFrame = false) {\n        let image;\n        data = mem.view(data);\n        const view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n\n        if (ImageType.isGIF(view)) { // GIF\n            const frames = [];\n            const decoder = new (await giflib.init()).Decoder(data);\n\n            if (onlyExtractFirstFrame) {\n                const first = decoder.frames().next().value;\n                const frame = new Frame(first.width, first.height, 10 * first.delay, first.x, first.y, first.dispose);\n\n                frame.bitmap.set(first.buffer);\n\n                frames.push(frame);\n                image = new GIF(frames);\n            }\n\n            const gwidth = decoder.width | 0;\n            const gheight = decoder.height | 0;\n            const u32 = new Uint32Array(decoder.width * decoder.height);\n            const u8 = new Uint8Array(u32.buffer, u32.byteOffset, u32.byteLength);\n\n            for (const frame of decoder.frames()) {\n                let offset8 = 0 | 0;\n                let offset32 = 0 | 0;\n                const fx = frame.x | 0;\n                const fy = frame.y | 0;\n                const f8 = frame.buffer;\n                const mode = frame.dispose;\n                const width = frame.width | 0;\n                const height = frame.height | 0;\n                const f32 = new Uint32Array(f8.buffer, f8.byteOffset, width * height);\n                const f = frames[frames.push(new Frame(gwidth, gheight, 10 * frame.delay, 0, 0, 3)) - 1];\n\n                const t8 = f.bitmap;\n                const t32 = new Uint32Array(t8.buffer);\n\n                t8.set(u8);\n\n                if (2 === mode) {\n                    for (let y = 0 | 0; y < height; y++) {\n                        const y_offset = fx + gwidth * (y + fy) | 0;\n\n                        for (let x = 0 | 0; x < width; x++) {\n                            const x_offset = x + y_offset;\n\n                            if (0 === f8[3 + offset8])\n                            t32[x_offset] = u32[x_offset];\n                            else t32[x_offset] = f32[offset32];\n\n                            offset32++;\n                            offset8 += 4;\n                        }\n                    }\n                }\n\n                else if (3 === mode) {\n                    for (let y = 0 | 0; y < height; y++) {\n                        const y_offset = fx + gwidth * (y + fy) | 0;\n\n                        for (let x = 0 | 0; x < width; x++) {\n                            const x_offset = x + y_offset;\n\n                            if (0 === f8[3 + offset8])\n                            t32[x_offset] = u32[x_offset];\n                            else t32[x_offset] = f32[offset32];\n\n                            offset32++;\n                            offset8 += 4;\n                            u32[x_offset] = 0;\n                        }\n                    }\n                }\n\n                else if (0 === mode || 1 === mode) {\n                    t8.set(u8)\n                    for (let y = 0 | 0; y < height; y++) {\n                        const y_offset = fx + gwidth * (y + fy) | 0;\n\n                        for (let x = 0 | 0; x < width; x++) {\n                            const x_offset = x + y_offset;\n\n                            if (0 === f8[3 + offset8])\n                            t32[x_offset] = u32[x_offset];\n                            else t32[x_offset] = f32[offset32];\n\n                            offset32++;\n                            offset8 += 4;\n                            u32[x_offset] = t32[x_offset];\n                        }\n                    }\n                }\n            }\n\n            image = new GIF(frames);\n        } else throw new Error('Unsupported image type');\n\n        return image;\n    }\n\n    resize(width, height, mode = Image.RESIZE_NEAREST_NEIGHBOR) {\n        for (const frame of this)\n            frame.resize(width, height, mode);\n    }\n}\n\nclass TextLayout {\n    /**\n     * Layout options for {@link renderText}\n     * @param {object} [options]\n     * @param {number} [options.maxWidth=Infinity] The texts max width\n     * @param {number} [options.maxHeight=Infinity] The texts max height\n     * @param {string} [options.wrapStyle='word'] The texts wrap style when reaching the max width (word, char)\n     * @param {string} [options.verticalAlign='left'] The vertical align mode (left, center, right)\n     * @param {string} [options.horizontalAlign='top'] The horizontal align mode (top, middle, bottom)\n     * @param {string} [options.wrapHardBreaks=true] Whether to force wrap at new line characters\n     */\n    constructor(options) {\n        const {maxWidth, maxHeight, wrapStyle, verticalAlign, horizontalAlign, wrapHardBreaks} = options || {};\n\n        this.maxWidth = maxWidth || Infinity;\n        if (isNaN(this.maxWidth) || this.maxWidth < 1)\n            throw new RangeError('Invalid maxWidth');\n\n        this.maxHeight = maxHeight || Infinity;\n        if (isNaN(this.maxHeight) || this.maxHeight < 1)\n            throw new RangeError('Invalid maxHeight');\n\n        this.wrapStyle = wrapStyle || 'word';\n        if (!['word', 'char'].includes(this.wrapStyle))\n            throw new RangeError('Invalid wrapStyle');\n\n        this.verticalAlign = verticalAlign || 'left';\n        if (!['left', 'center', 'right'].includes(this.verticalAlign))\n            throw new RangeError('Invalid verticalAlign');\n\n        this.horizontalAlign = horizontalAlign || 'top';\n        if (!['top', 'middle', 'bottom'].includes(this.horizontalAlign))\n            throw new RangeError('Invalid horizontalAlign');\n\n        this.wrapHardBreaks = wrapHardBreaks || true;\n        if (typeof this.wrapHardBreaks !== 'boolean')\n            throw new TypeError('Invalid wrapHardBreaks');\n    }\n}\n\nclass ImageType {\n    /**\n     * Gets an images type (png, jpeg, tiff, gif)\n     * @param {Buffer|Uint8Array} data The image binary to get the type of\n     * @returns {string|null} The image type (png, jpeg, tiff, gif, null)\n     */\n    static getType(data) {\n        let view;\n        if (!ArrayBuffer.isView(data)) {\n            data = new Uint8Array(data);\n            view = new DataView(data.buffer);\n        } else {\n            data = new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n            view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n        }\n\n        if (this.isPNG(view)) return 'png';\n        if (this.isJPEG(view)) return 'jpeg';\n        if (this.isTIFF(view)) return 'tiff';\n        if (this.isGIF(view)) return 'gif';\n        return null;\n    }\n\n    /**\n     * @param {DataView} view\n     * @returns {boolean}\n     */\n    static isPNG(view) {\n        return view.getUint32(0, false) === MAGIC_NUMBERS.PNG;\n    }\n\n    /**\n     * @param {DataView} view\n     * @returns {boolean}\n     */\n    static isJPEG(view) {\n        return (view.getUint32(0, false) >>> 8) === MAGIC_NUMBERS.JPEG;\n    }\n\n    /**\n     * @param {DataView} view\n     * @returns {boolean}\n     */\n    static isTIFF(view) {\n        return view.getUint32(0, false) === MAGIC_NUMBERS.TIFF;\n    }\n\n    /**\n     * @param {DataView} view\n     * @returns {boolean}\n     */\n    static isGIF(view) {\n        return (view.getUint32(0, false) >>> 8) === MAGIC_NUMBERS.GIF;\n    }\n}\n\n/**\n * Decodes the given image binary\n * @param {Uint8Array|Buffer} data The image data\n * @param {boolean} [onlyExtractFirstFrame] Whether to end GIF decoding after the first frame\n * @returns {Promise<GIF|Image>} The decoded image\n */\nfunction decode(data, onlyExtractFirstFrame) {\n    const type = ImageType.getType(data);\n\n    if (type === 'gif')\n        return GIF.decode(data, onlyExtractFirstFrame);\n    return Image.decode(data);\n}\n\nmodule.exports = {Image, GIF, Frame, TextLayout, ImageType, decode};\n","function view(buffer, shared = false) {\n    if (buffer instanceof ArrayBuffer) return new Uint8Array(buffer);\n    if (shared && buffer instanceof SharedArrayBuffer) return new Uint8Array(buffer);\n    if (ArrayBuffer.isView(buffer)) return new Uint8Array(buffer.buffer, buffer.byteOffset, buffer.byteLength);\n  \n    throw new TypeError(\"The provided value is not of type '(ArrayBuffer or ArrayBufferView)'\");\n  }\n  \n  function from_parts(buffers, shared = false) {\n    let length = 0;\n    let offset = 0;\n    buffers.forEach(buffer => length += (null == buffer.byteLength ? buffer.length : buffer.byteLength));\n  \n    const u8 = new Uint8Array(shared ? new SharedArrayBuffer(length) : length);\n  \n    buffers.forEach(buffer => {\n      const ref = Array.isArray(buffer) ? buffer : view(buffer, true);\n  \n      u8.set(ref, offset);\n      offset += ref.length;\n    });\n  \n    return u8;\n  }\n  \n  module.exports = { view, from_parts };","const table = new Uint32Array([\n    0x00000000, 0x77073096, 0xEE0E612C, 0x990951BA, 0x076DC419, 0x706AF48F, 0xE963A535, 0x9E6495A3, 0x0EDB8832,\n    0x79DCB8A4, 0xE0D5E91E, 0x97D2D988, 0x09B64C2B, 0x7EB17CBD, 0xE7B82D07, 0x90BF1D91, 0x1DB71064, 0x6AB020F2,\n    0xF3B97148, 0x84BE41DE, 0x1ADAD47D, 0x6DDDE4EB, 0xF4D4B551, 0x83D385C7, 0x136C9856, 0x646BA8C0, 0xFD62F97A,\n    0x8A65C9EC, 0x14015C4F, 0x63066CD9, 0xFA0F3D63, 0x8D080DF5, 0x3B6E20C8, 0x4C69105E, 0xD56041E4, 0xA2677172,\n    0x3C03E4D1, 0x4B04D447, 0xD20D85FD, 0xA50AB56B, 0x35B5A8FA, 0x42B2986C, 0xDBBBC9D6, 0xACBCF940, 0x32D86CE3,\n    0x45DF5C75, 0xDCD60DCF, 0xABD13D59, 0x26D930AC, 0x51DE003A, 0xC8D75180, 0xBFD06116, 0x21B4F4B5, 0x56B3C423,\n    0xCFBA9599, 0xB8BDA50F, 0x2802B89E, 0x5F058808, 0xC60CD9B2, 0xB10BE924, 0x2F6F7C87, 0x58684C11, 0xC1611DAB,\n    0xB6662D3D, 0x76DC4190, 0x01DB7106, 0x98D220BC, 0xEFD5102A, 0x71B18589, 0x06B6B51F, 0x9FBFE4A5, 0xE8B8D433,\n    0x7807C9A2, 0x0F00F934, 0x9609A88E, 0xE10E9818, 0x7F6A0DBB, 0x086D3D2D, 0x91646C97, 0xE6635C01, 0x6B6B51F4,\n    0x1C6C6162, 0x856530D8, 0xF262004E, 0x6C0695ED, 0x1B01A57B, 0x8208F4C1, 0xF50FC457, 0x65B0D9C6, 0x12B7E950,\n    0x8BBEB8EA, 0xFCB9887C, 0x62DD1DDF, 0x15DA2D49, 0x8CD37CF3, 0xFBD44C65, 0x4DB26158, 0x3AB551CE, 0xA3BC0074,\n    0xD4BB30E2, 0x4ADFA541, 0x3DD895D7, 0xA4D1C46D, 0xD3D6F4FB, 0x4369E96A, 0x346ED9FC, 0xAD678846, 0xDA60B8D0,\n    0x44042D73, 0x33031DE5, 0xAA0A4C5F, 0xDD0D7CC9, 0x5005713C, 0x270241AA, 0xBE0B1010, 0xC90C2086, 0x5768B525,\n    0x206F85B3, 0xB966D409, 0xCE61E49F, 0x5EDEF90E, 0x29D9C998, 0xB0D09822, 0xC7D7A8B4, 0x59B33D17, 0x2EB40D81,\n    0xB7BD5C3B, 0xC0BA6CAD, 0xEDB88320, 0x9ABFB3B6, 0x03B6E20C, 0x74B1D29A, 0xEAD54739, 0x9DD277AF, 0x04DB2615,\n    0x73DC1683, 0xE3630B12, 0x94643B84, 0x0D6D6A3E, 0x7A6A5AA8, 0xE40ECF0B, 0x9309FF9D, 0x0A00AE27, 0x7D079EB1,\n    0xF00F9344, 0x8708A3D2, 0x1E01F268, 0x6906C2FE, 0xF762575D, 0x806567CB, 0x196C3671, 0x6E6B06E7, 0xFED41B76,\n    0x89D32BE0, 0x10DA7A5A, 0x67DD4ACC, 0xF9B9DF6F, 0x8EBEEFF9, 0x17B7BE43, 0x60B08ED5, 0xD6D6A3E8, 0xA1D1937E,\n    0x38D8C2C4, 0x4FDFF252, 0xD1BB67F1, 0xA6BC5767, 0x3FB506DD, 0x48B2364B, 0xD80D2BDA, 0xAF0A1B4C, 0x36034AF6,\n    0x41047A60, 0xDF60EFC3, 0xA867DF55, 0x316E8EEF, 0x4669BE79, 0xCB61B38C, 0xBC66831A, 0x256FD2A0, 0x5268E236,\n    0xCC0C7795, 0xBB0B4703, 0x220216B9, 0x5505262F, 0xC5BA3BBE, 0xB2BD0B28, 0x2BB45A92, 0x5CB36A04, 0xC2D7FFA7,\n    0xB5D0CF31, 0x2CD99E8B, 0x5BDEAE1D, 0x9B64C2B0, 0xEC63F226, 0x756AA39C, 0x026D930A, 0x9C0906A9, 0xEB0E363F,\n    0x72076785, 0x05005713, 0x95BF4A82, 0xE2B87A14, 0x7BB12BAE, 0x0CB61B38, 0x92D28E9B, 0xE5D5BE0D, 0x7CDCEFB7,\n    0x0BDBDF21, 0x86D3D2D4, 0xF1D4E242, 0x68DDB3F8, 0x1FDA836E, 0x81BE16CD, 0xF6B9265B, 0x6FB077E1, 0x18B74777,\n    0x88085AE6, 0xFF0F6A70, 0x66063BCA, 0x11010B5C, 0x8F659EFF, 0xF862AE69, 0x616BFFD3, 0x166CCF45, 0xA00AE278,\n    0xD70DD2EE, 0x4E048354, 0x3903B3C2, 0xA7672661, 0xD06016F7, 0x4969474D, 0x3E6E77DB, 0xAED16A4A, 0xD9D65ADC,\n    0x40DF0B66, 0x37D83BF0, 0xA9BCAE53, 0xDEBB9EC5, 0x47B2CF7F, 0x30B5FFE9, 0xBDBDF21C, 0xCABAC28A, 0x53B39330,\n    0x24B4A3A6, 0xBAD03605, 0xCDD70693, 0x54DE5729, 0x23D967BF, 0xB3667A2E, 0xC4614AB8, 0x5D681B02, 0x2A6F2B94,\n    0xB40BBE37, 0xC30C8EA1, 0x5A05DF1B, 0x2D02EF8D]);\n  \n  module.exports = function crc32(buffer) {\n    let offset = 0 | 0;\n    let crc = 0xFFFFFFFF | 0;\n    const bl = (buffer.length - 4) | 0;\n  \n    while (bl > offset) {\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n    }\n  \n    while (offset < buffer.length) {\n      crc = table[(crc ^ buffer[offset++]) & 0xff] ^ (crc >>> 8);\n    }\n  \n    return (crc ^ 0xFFFFFFFF) >>> 0;\n  };","/* global SharedArrayBuffer */\nconst mem = require('./buffer.js');\nconst crc32 = require('./crc32.js');\nconst { compress, decompress } = require('./zlib.js');\n\nconst __IHDR__ = new Uint8Array([73, 72, 68, 82]);\nconst __IDAT__ = new Uint8Array([73, 68, 65, 84]);\nconst __IEND__ = new Uint8Array([73, 69, 78, 68]);\nconst __IEND_CRC__ = crc32(new Uint8Array([73, 69, 78, 68]));\nconst HEAD = new Uint8Array([137, 80, 78, 71, 13, 10, 26, 10]);\n\nconst color_types = {\n  GREYSCALE: 0,\n  TRUECOLOR: 2,\n  INDEXED_COLOR: 3,\n  GREYSCALE_ALPHA: 4,\n  TRUECOLOR_ALPHA: 6\n};\n\nconst channels_to_color_type = {\n  1: color_types.GREYSCALE,\n  2: color_types.GREYSCALE_ALPHA,\n\n  3: color_types.TRUECOLOR,\n  4: color_types.TRUECOLOR_ALPHA\n};\n\nconst utf8encoder = new TextEncoder; // replace with latin1 encoder or iext\n\nmodule.exports = {\n  encode(data, { text, width, height, channels, depth = 8, level = 0 }) {\n    let offset = 0;\n    let tmp_offset = 0;\n    const row_length = width * channels;\n    const tmp = new Uint8Array(height + data.length);\n\n    while (offset < data.length) {\n      tmp[tmp_offset++] = 0;\n      tmp.set(data.subarray(offset, (offset += row_length)), tmp_offset);\n\n      tmp_offset += row_length;\n    }\n\n    if (text) {\n      let chunks = [];\n      for (const key in text) {\n        if (!text[key]) continue;\n        const kb = utf8encoder.encode(key);\n        const tb = utf8encoder.encode(text[key]);\n        const chunk = new Uint8Array(1 + 12 + kb.length + tb.length);\n\n        const view = new DataView(chunk.buffer);\n\n        chunk[4] = 0x74;\n        chunk[5] = 0x45;\n        chunk[6] = 0x58;\n        chunk[7] = 0x74;\n        chunk.set(kb, 8);\n        chunks.push(chunk);\n        chunk.set(tb, 9 + kb.length);\n        view.setUint32(0, chunk.length - 12);\n        view.setUint32(chunk.length - 4, crc32(chunk.subarray(4, chunk.length - 4)));\n      }\n\n      text = mem.from_parts(chunks);\n    }\n\n    offset = text ? text.length : 0;\n    const compressed = compress(tmp, level);\n    const array = new Uint8Array(49 + offset + HEAD.length + compressed.length);\n\n    array[26] = 0;\n    array[27] = 0;\n    array[28] = 0;\n    array[24] = depth;\n    array.set(HEAD, 0);\n    array.set(__IHDR__, 12);\n    array.set(__IDAT__, 37);\n    array.set(compressed, 41);\n    array[25] = channels_to_color_type[channels];\n    if (text) array.set(text, 45 + compressed.length);\n    array.set(__IEND__, 49 + offset + compressed.length);\n\n    const view = new DataView(array.buffer);\n\n    view.setUint32(8, 13);\n    view.setUint32(16, width);\n    view.setUint32(20, height);\n    view.setUint32(33, compressed.length);\n    view.setUint32(45 + offset + compressed.length, 0);\n    view.setUint32(53 + offset + compressed.length, __IEND_CRC__);\n    view.setUint32(29, crc32(new Uint8Array(array.buffer, 12, 17)));\n    view.setUint32(41 + compressed.length, crc32(new Uint8Array(array.buffer, 37, 4 + compressed.length)));\n\n    return array;\n  },\n\n  decode(array) {\n    let view = new DataView(array.buffer, array.byteOffset, array.byteLength);\n\n    const width = view.getUint32(16);\n    const height = view.getUint32(20);\n    const bpc = array[24];\n    const pixel_type = array[25];\n    let channels = ({ 3: 1, 0: 1, 4: 2, 2: 3, 6: 4 })[pixel_type];\n    const bytespp = channels * bpc / 8;\n\n    const row_length = width * bytespp;\n    let pixels = new Uint8Array(height * row_length);\n\n    let offset = 0;\n    let p_offset = 0;\n\n    let c_offset = 33;\n    const chunks = [];\n\n    let palette, alphaPalette;\n\n    const maxSearchOffset = array.length - 5;\n\n    let type;\n    while ((type = view.getUint32(4 + c_offset)) !== 1229278788) { // IEND\n      if (type === 1229209940) // IDAT\n        chunks.push(array.subarray(8 + c_offset, 8 + c_offset + view.getUint32(c_offset)));\n      else if (type === 1347179589) { // PLTE\n        if (palette)\n          throw new Error('PLTE can only occur once in an image');\n        palette = new Uint32Array(view.getUint32(c_offset));\n        for (let pxlOffset = 0; pxlOffset < palette.length * 8; pxlOffset += 3)\n          palette[pxlOffset / 3] = array[8 + c_offset + pxlOffset] << 24 | array[8 + c_offset + pxlOffset + 1] << 16 | array[8 + c_offset + pxlOffset + 2] << 8 | 0xff;\n      } else if (type === 1951551059) { // tRNS\n        if (alphaPalette)\n          throw new Error('tRNS can only occur once in an image');\n        alphaPalette = new Uint8Array(view.getUint32(c_offset));\n        for (let i = 0; i < alphaPalette.length; i++)\n          alphaPalette[i] = array[8 + c_offset + i];\n      }\n\n      c_offset += 4 + 4 + 4 + view.getUint32(c_offset);\n      if (c_offset > maxSearchOffset) // missing IEND\n        break;\n    }\n\n    array = decompress(chunks.length === 1 ? chunks[0] : mem.from_parts(chunks), height + height * row_length);\n\n    while (offset < array.byteLength) {\n      const filter = array[offset++];\n      const slice = array.subarray(offset, offset += row_length);\n\n      if (0 === filter) pixels.set(slice, p_offset);\n      else if (1 === filter) this.filter_1(slice, pixels, p_offset, bytespp, row_length);\n      else if (2 === filter) this.filter_2(slice, pixels, p_offset, bytespp, row_length);\n      else if (3 === filter) this.filter_3(slice, pixels, p_offset, bytespp, row_length);\n      else if (4 === filter) this.filter_4(slice, pixels, p_offset, bytespp, row_length);\n\n      p_offset += row_length;\n    }\n\n    if (pixel_type === 3) {\n      if (!palette)\n        throw new Error('Indexed color PNG has no PLTE');\n\n      if (alphaPalette)\n        for (let i = 0; i < alphaPalette.length; i++)\n          palette[i] &= 0xffffff00 | alphaPalette[i];\n\n      channels = 4;\n      const newPixels = new Uint8Array(width * height * 4);\n      const pixelView = new DataView(newPixels.buffer, newPixels.byteOffset, newPixels.byteLength);\n      for (let i = 0; i < pixels.length; i++)\n        pixelView.setUint32(i * 4, palette[pixels[i]], false);\n      pixels = newPixels;\n    }\n\n    if (bpc !== 8) {\n      const newPixels = new Uint8Array(pixels.length / bpc * 8);\n      for (let i = 0; i < pixels.length; i += 2)\n        newPixels[i / 2] = pixels[i];\n      pixels = newPixels;\n    }\n\n    if (channels !== 4) {\n      const newPixels = new Uint8Array(width * height * 4);\n      const view = new DataView(newPixels.buffer);\n\n      if (channels === 1) {\n        for (let i = 0; i < width * height; i++) {\n          const pixel = pixels[i];\n          view.setUint32(i * 4, pixel << 24 | pixel << 16 | pixel << 8 | 0xff, false);\n        }\n      } else if (channels === 2) {\n        for (let i = 0; i < width * height * 2; i += 2) {\n          const pixel = pixels[i];\n          view.setUint32(i * 2, pixel << 24 | pixel << 16 | pixel << 8 | pixels[i + 1], false);\n        }\n      } else if (channels === 3) {\n        newPixels.fill(0xff);\n        for (let i = 0; i < width * height; i++)\n          newPixels.set(pixels.subarray(i * 3, i * 3 + 3), i * 4);\n      }\n\n      pixels = newPixels;\n    }\n\n    return { width, height, pixels };\n  },\n\n  filter_1(slice, pixels, p_offset, bytespp, row_length) {\n    let i = 0;\n    while (i < bytespp) pixels[i + p_offset] = slice[i++];\n    while (i < row_length) pixels[i + p_offset] = slice[i] + pixels[i++ + p_offset - bytespp];\n  },\n\n  filter_2(slice, pixels, p_offset, bytespp, row_length) {\n    if (0 === p_offset) pixels.set(slice, p_offset);\n    else {\n      let i = 0;\n      while (i < row_length) pixels[i + p_offset] = slice[i] + pixels[i++ + p_offset - row_length];\n    }\n  },\n\n  filter_3(slice, pixels, p_offset, bytespp, row_length) {\n    let i = 0;\n\n    if (0 === p_offset) {\n      while (i < bytespp) pixels[i] = slice[i++];\n      while (i < row_length) pixels[i] = slice[i] + (pixels[i++ - bytespp] >> 1);\n    } else {\n      while (i < bytespp) pixels[i + p_offset] = slice[i] + (pixels[i++ + p_offset - row_length] >> 1);\n      while (i < row_length) pixels[i + p_offset] = slice[i] + (pixels[i + p_offset - bytespp] + pixels[i++ + p_offset - row_length] >> 1);\n    }\n  },\n\n  filter_4(slice, pixels, p_offset, bytespp, row_length) {\n    let i = 0;\n\n    if (0 === p_offset) {\n      while (i < bytespp) pixels[i] = slice[i++];\n      while (i < row_length) pixels[i] = slice[i] + pixels[i++ - bytespp];\n    } else {\n      while (i < bytespp) pixels[i + p_offset] = slice[i] + pixels[i++ + p_offset - row_length];\n\n      while (i < row_length) {\n        const a = pixels[i + p_offset - bytespp];\n        const b = pixels[i + p_offset - row_length];\n        const c = pixels[i + p_offset - bytespp - row_length];\n\n        const p = a + b - c;\n        const pa = Math.abs(p - a);\n        const pb = Math.abs(p - b);\n        const pc = Math.abs(p - c);\n\n        pixels[i + p_offset] = slice[i++] + ((pa <= pb && pa <= pc) ? a : ((pb <= pc) ? b : c));\n      }\n    }\n  }\n};","const {version} = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n  async init() {\n    if (!mod) {\n      const streaming = 'compileStreaming' in WebAssembly;\n      mod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/utils/wasm/font.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n    }\n  \n    return this.new();\n  },\n\n  new() {\n    let registry = null;\n    const wasm = new WebAssembly.Instance(mod).exports;\n\n    class mem {\n      static length() { return wasm.wlen(); }\n      static alloc(size) { return wasm.walloc(size); }\n      static free(ptr, size) { return wasm.wfree(ptr, size); }\n      static u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n      static u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n      static copy_and_free(ptr, size) {\n        let slice = mem.u8(ptr, size).slice();\n        return (wasm.wfree(ptr, size), slice);\n      }\n    }\n    const encode_utf8 = 'Deno' in globalThis ? Deno.core.encode : (() => {\n      const encoder = new TextEncoder();\n      return string => encoder.encode(string);\n    })();\n\n    const decode_utf8 = 'Deno' in globalThis ? Deno.core.decode : (() => {\n      const decoder = new TextDecoder();\n      return buffer => decoder.decode(buffer);\n    })();\n\n    if ('FinalizationRegistry' in globalThis) {\n      registry = new FinalizationRegistry(([t, ptr]) => {\n        if (t === 0) wasm.font_free(ptr);\n        if (t === 1) wasm.layout_free(ptr);\n      });\n    }\n\n    class Font {\n      constructor(scale, buffer) {\n        this.scale = scale;\n        const ptr = mem.alloc(buffer.length);\n        mem.u8(ptr, buffer.length).set(buffer);\n        this.ptr = wasm.font_new(ptr, buffer.length, scale);\n\n        if (!this.ptr) throw new Error('invalid font');\n        if (registry) registry.register(this, [0, this.ptr], this);\n      }\n\n      free() {\n        this.ptr = wasm.font_free(this.ptr);\n        if (registry) registry.unregister(this);\n      }\n\n      has(char) {\n        return wasm.font_has(this.ptr, String.prototype.charCodeAt.call(char, 0));\n      }\n\n      metrics(char, scale = this.scale) {\n        const ptr = wasm.font_metrics(this.ptr, String.prototype.charCodeAt.call(char, 0), scale);\n        const metrics = JSON.parse(decode_utf8(mem.u8(wasm.font_metrics_buffer(ptr), mem.length())));\n\n        return (wasm.font_metrics_free(ptr), metrics);\n      }\n\n      rasterize(char, scale = this.scale) {\n        const ptr = wasm.font_rasterize(this.ptr, String.prototype.charCodeAt.call(char, 0), scale);\n\n        const glyph = {\n          buffer: mem.u8(wasm.font_rasterize_buffer(ptr), mem.length()).slice(),\n          metrics: JSON.parse(decode_utf8(mem.u8(wasm.font_rasterize_metrics(ptr), mem.length()))),\n        }\n\n        return (wasm.font_rasterize_free(ptr), glyph);\n      }\n    }\n\n    class Layout {\n      constructor() {\n        this.ptr = wasm.layout_new();\n        if (registry) this.refs = [];\n        if (registry) registry.register(this, [1, this.ptr], this);\n      }\n\n      clear() {\n        wasm.layout_clear(this.ptr);\n        if (registry) this.refs.length = 0;\n      }\n\n      lines() {\n        return wasm.layout_lines(this.ptr);\n      }\n\n      free() {\n        if (registry) this.refs.length = 0;\n        this.ptr = wasm.layout_free(this.ptr);\n        if (registry) registry.unregister(this);\n      }\n\n      reset(options = {}) {\n        options = encode_utf8(JSON.stringify(options));\n\n        if (registry) this.refs.length = 0;\n        const ptr = mem.alloc(options.length);\n        mem.u8(ptr, options.length).set(options);\n        wasm.layout_reset(this.ptr, ptr, options.length);\n      }\n\n      append(font, text, init) {\n        text = encode_utf8(text);\n        const options = init || {};\n        if (registry) this.refs.push(font);\n        const ptr = mem.alloc(text.length);\n        mem.u8(ptr, text.length).set(text);\n        const has_color = ('r' in options) || ('g' in options) || ('b' in options);\n        wasm.layout_append(this.ptr, font.ptr, ptr, text.length, options.scale == null ? font.scale : options.scale, has_color, options.r, options.g, options.b);\n      }\n\n      rasterize(r, g, b) {\n        const ptr = wasm.layout_rasterize(this.ptr, r, g, b);\n\n        const framebuffer = {\n          width: wasm.layout_rasterize_width(ptr),\n          height: wasm.layout_rasterize_height(ptr),\n          buffer: mem.u8(wasm.layout_rasterize_buffer(ptr), mem.length()).slice(),\n        }\n\n        return (wasm.layout_rasterize_free(ptr), framebuffer);\n      }\n    }\n\n    return { Font, Layout };\n  },\n}","const {version} = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n  async init() {\n\t\tif (!mod) {\n      const streaming = 'compileStreaming' in WebAssembly;\n      mod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/utils/wasm/gif.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n    };\n\n    return this.new();\n  },\n\n  new() {\n    const streams = new Map;\n    const utf8encoder = new TextEncoder;\n\n    const wasm = new WebAssembly.Instance(mod, {\n      env: {\n        push_to_stream(id, ptr) {\n          streams.get(id).cb(mem.u8(ptr, mem.length()).slice());\n        },\n      },\n    }).exports;\n\n    class mem {\n      static length() { return wasm.wlen(); }\n      static alloc(size) { return wasm.walloc(size); }\n      static free(ptr, size) { return wasm.wfree(ptr, size); }\n      static u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n      static u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n      static copy_and_free(ptr, size) {\n        let slice = mem.u8(ptr, size).slice();\n        return (wasm.wfree(ptr, size), slice);\n      }\n    }\n\n    class Encoder {\n      constructor(width, height, loops = -1) {\n        this.slices = [];\n        streams.set(0, this);\n        this.ptr = wasm.encoder_new(0, width, height, loops);\n      }\n    \n      cb(buffer) {\n        this.slices.push(buffer);\n      }\n    \n      free() {\n        this.ptr = wasm.encoder_free(this.ptr);\n        streams.delete(0);\n      }\n    \n      u8() {\n        this.free();\n        let offset = 0;\n        const u8 = new Uint8Array(this.slices.reduce((sum, array) => sum + array.length, 0));\n    \n        for (const x of this.slices) {\n          u8.set(x, offset);\n          offset += x.length;\n        }\n    \n        return u8;\n      }\n    \n      add(x, y, delay, width, height, buffer, dispose, quality) {\n        const ptr = mem.alloc(buffer.length);\n        mem.u8(ptr, buffer.length).set(buffer);\n        wasm.encoder_add(this.ptr, ptr, buffer.length, x, y, width, height, delay, dispose, quality);\n      }\n    \n      set comment(comment) {\n        const buffer = utf8encoder.encode(comment);\n    \n        const ptr = mem.alloc(buffer.length);\n        mem.u8(ptr, buffer.length).set(buffer);\n        wasm.encoder_add_comment(this.ptr, ptr, buffer.length);\n      }\n    \n      set application(application) {\n        const buffer = utf8encoder.encode(application);\n    \n        const ptr = mem.alloc(buffer.length);\n        mem.u8(ptr, buffer.length).set(buffer);\n        wasm.encoder_add_application(this.ptr, ptr, buffer.length);\n      }\n    }\n\n    class Decoder {\n      constructor(buffer, limit = 0) {\n        const bptr = mem.alloc(buffer.length);\n        mem.u8(bptr, buffer.length).set(buffer);\n        this.ptr = wasm.decoder_new(bptr, buffer.length, limit);\n        if (0 === this.ptr) throw new Error('gif: failed to parse gif header');\n\n        this.width = wasm.decoder_width(this.ptr);\n        this.height = wasm.decoder_height(this.ptr);\n      }\n\n      free() {\n        this.ptr = wasm.decoder_free(this.ptr);\n      }\n\n      *frames() {\n        let frame;\n        while (frame = this.frame()) yield frame;\n      }\n\n      frame() {\n        const ptr = wasm.decoder_frame(this.ptr);\n\n        if (1 === ptr) return null;\n        if (0 === ptr) throw (this.free(), new Error('gif: failed to decode frame'));\n\n        const framebuffer = {\n          x: wasm.decoder_frame_x(ptr),\n          y: wasm.decoder_frame_y(ptr),\n          delay: wasm.decoder_frame_delay(ptr),\n          width: wasm.decoder_frame_width(ptr),\n          height: wasm.decoder_frame_height(ptr),\n          dispose: wasm.decoder_frame_dispose(ptr),\n          buffer: mem.u8(wasm.decoder_frame_buffer(ptr), mem.length()).slice(),\n        };\n\n        return (wasm.decoder_frame_free(ptr), framebuffer);\n      }\n    }\n\n    return { Encoder, Decoder };\n  },\n}\n","const {version} = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n  async init() {\n    if (!mod) {\n      const streaming = 'compileStreaming' in WebAssembly;\n      mod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/utils/wasm/jpeg.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n    };\n\n    return this.new();\n  },\n\n  new() {\n    const wasm = new WebAssembly.Instance(mod).exports;\n\n    class mem {\n      static length() { return wasm.wlen(); }\n      static alloc(size) { return wasm.walloc(size); }\n      static free(ptr, size) { return wasm.wfree(ptr, size); }\n      static u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n      static u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n      static copy_and_free(ptr, size) {\n        let slice = mem.u8(ptr, size).slice();\n        return (wasm.wfree(ptr, size), slice);\n      }\n    }\n\n    function encode(buffer, width, height, quality) {\n      const ptr = mem.alloc(buffer.length);\n      mem.u8(ptr, buffer.length).set(buffer);\n      return mem.copy_and_free(wasm.encode(ptr, width, height, quality), mem.length());\n    }\n    \n    function decode(buffer, width, height) {\n      const bptr = mem.alloc(buffer.length);\n      mem.u8(bptr, buffer.length).set(buffer);\n      const ptr = wasm.decode(bptr, buffer.length, width, height);\n    \n      if (0 === ptr) throw new Error('jpg: failed to decode');\n      if (1 === ptr) throw new Error('jpg: failed to scale decoder');\n    \n      const framebuffer = {\n        width: wasm.decode_width(ptr),\n        height: wasm.decode_height(ptr),\n        format: wasm.decode_format(ptr),\n        buffer: mem.u8(wasm.decode_buffer(ptr), mem.length()).slice(),\n      }\n    \n      return (wasm.decode_free(ptr), framebuffer);\n    }\n\n    return { encode, decode };\n  },\n}","const { version } = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n  async init() {\n    if (!mod) {\n      const streaming = 'compileStreaming' in WebAssembly;\n      mod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/utils/wasm/svg.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n    };\n\n    return this.new();\n  },\n\n  new() {\n    const wasm = new WebAssembly.Instance(mod).exports;\n\n    class mem {\n      static length() { return wasm.wlen(); }\n      static alloc(size) { return wasm.walloc(size); }\n      static free(ptr, size) { return wasm.wfree(ptr, size); }\n      static u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n      static u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n      static copy_and_free(ptr, size) {\n        let slice = mem.u8(ptr, size).slice();\n        return (wasm.wfree(ptr, size), slice);\n      }\n    }\n\n    function rasterize(buffer, fit, scale) {\n      const bptr = mem.alloc(buffer.length);\n      mem.u8(bptr, buffer.length).set(buffer);\n      const ptr = wasm.rasterize(bptr, buffer.length, fit, scale);\n\n      if (0 === ptr) throw new Error('svg: failed to parse');\n      if (1 === ptr) throw new Error('svg: failed to rasterize');\n\n      const framebuffer = {\n        width: wasm.rasterize_width(ptr),\n        height: wasm.rasterize_height(ptr),\n        buffer: mem.u8(wasm.rasterize_buffer(ptr), mem.length()).slice(),\n      }\n\n      return (wasm.rasterize_free(ptr), framebuffer);\n    }\n\n    return { rasterize };\n  },\n}\n","const { version } = require('../../package.json');\n\nlet mod = null;\nmodule.exports = {\n\tasync init() {\n\t\tif (!mod) {\n\t\t\tconst streaming = 'compileStreaming' in WebAssembly;\n\t\t\tmod = await WebAssembly[!streaming ? 'compile' : 'compileStreaming'](await fetch(`https://unpkg.com/imagescript@${version}/utils/wasm/tiff.wasm`).then(x => streaming ? x : x.arrayBuffer()));\n\t\t};\n\n\t\treturn this.new();\n\t},\n\n\tnew() {\n\t\tconst wasm = new WebAssembly.Instance(mod).exports;\n\n\t\tclass mem {\n\t\t\tstatic length() { return wasm.wlen(); }\n\t\t\tstatic alloc(size) { return wasm.walloc(size); }\n\t\t\tstatic free(ptr, size) { return wasm.wfree(ptr, size); }\n\t\t\tstatic u8(ptr, size) { return new Uint8Array(wasm.memory.buffer, ptr, size); }\n\t\t\tstatic u32(ptr, size) { return new Uint32Array(wasm.memory.buffer, ptr, size); }\n\n\t\t\tstatic copy_and_free(ptr, size) {\n\t\t\t\tlet slice = mem.u8(ptr, size).slice();\n\t\t\t\treturn (wasm.wfree(ptr, size), slice);\n\t\t\t}\n\t\t}\n\n\t\tfunction decode(buffer) {\n\t\t\tconst bptr = mem.alloc(buffer.length);\n\t\t\tmem.u8(bptr, buffer.length).set(buffer);\n\t\t\tconst ptr = wasm.decode(bptr, buffer.length);\n\t\t\tif (0 === ptr) throw new Error('tiff: failed to decode');\n\n\t\t\tconst framebuffer = {\n\t\t\t\twidth: wasm.decode_width(ptr),\n\t\t\t\theight: wasm.decode_height(ptr),\n\t\t\t\tbuffer: mem.u8(wasm.decode_buffer(ptr), mem.length()).slice(),\n\t\t\t}\n\n\t\t\treturn (wasm.decode_free(ptr), framebuffer);\n\t\t}\n\n\t\treturn { decode };\n\t},\n}\n","// node_modules/fflate/esm/browser.js\n// https://github.com/101arrowz/fflate\n\n// MIT License\n\n// Copyright (c) 2020 Arjun Barrett\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n\n\nvar u8 = Uint8Array;\nvar u16 = Uint16Array;\nvar u32 = Uint32Array;\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0, 0]);\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 0, 0]);\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\nvar freb = function (eb, start) {\n  var b = new u16(31);\n  for (var i = 0; i < 31; ++i) {\n    b[i] = start += 1 << eb[i - 1];\n  }\n  var r = new u32(b[30]);\n  for (var i = 1; i < 30; ++i) {\n    for (var j = b[i]; j < b[i + 1]; ++j) {\n      r[j] = j - b[i] << 5 | i;\n    }\n  }\n  return [b, r];\n};\nvar _a = freb(fleb, 2);\nvar fl = _a[0];\nvar revfl = _a[1];\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0);\nvar fd = _b[0];\nvar revfd = _b[1];\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n  x = (i & 43690) >>> 1 | (i & 21845) << 1;\n  x = (x & 52428) >>> 2 | (x & 13107) << 2;\n  x = (x & 61680) >>> 4 | (x & 3855) << 4;\n  rev[i] = ((x & 65280) >>> 8 | (x & 255) << 8) >>> 1;\n}\nvar x;\nvar hMap = function (cd, mb, r) {\n  var s = cd.length;\n  var i = 0;\n  var l = new u16(mb);\n  for (; i < s; ++i)\n    ++l[cd[i] - 1];\n  var le = new u16(mb);\n  for (i = 0; i < mb; ++i) {\n    le[i] = le[i - 1] + l[i - 1] << 1;\n  }\n  var co;\n  if (r) {\n    co = new u16(1 << mb);\n    var rvb = 15 - mb;\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        var sv = i << 4 | cd[i];\n        var r_1 = mb - cd[i];\n        var v = le[cd[i] - 1]++ << r_1;\n        for (var m = v | (1 << r_1) - 1; v <= m; ++v) {\n          co[rev[v] >>> rvb] = sv;\n        }\n      }\n    }\n  } else {\n    co = new u16(s);\n    for (i = 0; i < s; ++i) {\n      if (cd[i]) {\n        co[i] = rev[le[cd[i] - 1]++] >>> 15 - cd[i];\n      }\n    }\n  }\n  return co;\n};\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n  flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n  flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n  flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n  flt[i] = 8;\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n  fdt[i] = 5;\nvar flm = hMap(flt, 9, 0);\nvar flrm = hMap(flt, 9, 1);\nvar fdm = hMap(fdt, 5, 0);\nvar fdrm = hMap(fdt, 5, 1);\nvar max = function (a) {\n  var m = a[0];\n  for (var i = 1; i < a.length; ++i) {\n    if (a[i] > m)\n      m = a[i];\n  }\n  return m;\n};\nvar bits = function (d, p, m) {\n  var o = p >> 3 | 0;\n  return (d[o] | d[o + 1] << 8) >> (p & 7) & m;\n};\nvar bits16 = function (d, p) {\n  var o = p >> 3 | 0;\n  return (d[o] | d[o + 1] << 8 | d[o + 2] << 16) >> (p & 7);\n};\nvar shft = function (p) {\n  return (p >> 3 | 0) + (p & 7 && 1);\n};\nvar slc = function (v, s, e) {\n  if (s == null || s < 0)\n    s = 0;\n  if (e == null || e > v.length)\n    e = v.length;\n  var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n  n.set(v.subarray(s, e));\n  return n;\n};\nvar inflt = function (dat, buf, st) {\n  var sl = dat.length;\n  if (!sl || st && !st.l && sl < 5)\n    return buf || new u8(0);\n  var noBuf = !buf || st;\n  var noSt = !st || st.i;\n  if (!st)\n    st = {};\n  if (!buf)\n    buf = new u8(sl * 3);\n  var cbuf = function (l2) {\n    var bl = buf.length;\n    if (l2 > bl) {\n      var nbuf = new u8(Math.max(bl * 2, l2));\n      nbuf.set(buf);\n      buf = nbuf;\n    }\n  };\n  var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n  var tbts = sl * 8;\n  do {\n    if (!lm) {\n      st.f = final = bits(dat, pos, 1);\n      var type = bits(dat, pos + 1, 3);\n      pos += 3;\n      if (!type) {\n        var s = shft(pos) + 4, l = dat[s - 4] | dat[s - 3] << 8, t = s + l;\n        if (t > sl) {\n          if (noSt)\n            throw \"unexpected EOF\";\n          break;\n        }\n        if (noBuf)\n          cbuf(bt + l);\n        buf.set(dat.subarray(s, t), bt);\n        st.b = bt += l, st.p = pos = t * 8;\n        continue;\n      } else if (type === 1)\n        lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n      else if (type === 2) {\n        var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n        var tl = hLit + bits(dat, pos + 5, 31) + 1;\n        pos += 14;\n        var ldt = new u8(tl);\n        var clt = new u8(19);\n        for (var i = 0; i < hcLen; ++i) {\n          clt[clim[i]] = bits(dat, pos + i * 3, 7);\n        }\n        pos += hcLen * 3;\n        var clb = max(clt), clbmsk = (1 << clb) - 1;\n        var clm = hMap(clt, clb, 1);\n        for (var i = 0; i < tl;) {\n          var r = clm[bits(dat, pos, clbmsk)];\n          pos += r & 15;\n          var s = r >>> 4;\n          if (s < 16) {\n            ldt[i++] = s;\n          } else {\n            var c = 0, n = 0;\n            if (s === 16)\n              n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n            else if (s === 17)\n              n = 3 + bits(dat, pos, 7), pos += 3;\n            else if (s === 18)\n              n = 11 + bits(dat, pos, 127), pos += 7;\n            while (n--)\n              ldt[i++] = c;\n          }\n        }\n        var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n        lbt = max(lt);\n        dbt = max(dt);\n        lm = hMap(lt, lbt, 1);\n        dm = hMap(dt, dbt, 1);\n      } else\n        throw \"invalid block type\";\n      if (pos > tbts) {\n        if (noSt)\n          throw \"unexpected EOF\";\n        break;\n      }\n    }\n    if (noBuf)\n      cbuf(bt + 131072);\n    var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n    var lpos = pos;\n    for (; ; lpos = pos) {\n      var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n      pos += c & 15;\n      if (pos > tbts) {\n        if (noSt)\n          throw \"unexpected EOF\";\n        break;\n      }\n      if (!c)\n        throw \"invalid length/literal\";\n      if (sym < 256)\n        buf[bt++] = sym;\n      else if (sym === 256) {\n        lpos = pos, lm = null;\n        break;\n      } else {\n        var add = sym - 254;\n        if (sym > 264) {\n          var i = sym - 257, b = fleb[i];\n          add = bits(dat, pos, (1 << b) - 1) + fl[i];\n          pos += b;\n        }\n        var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n        if (!d)\n          throw \"invalid distance\";\n        pos += d & 15;\n        var dt = fd[dsym];\n        if (dsym > 3) {\n          var b = fdeb[dsym];\n          dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n        }\n        if (pos > tbts) {\n          if (noSt)\n            throw \"unexpected EOF\";\n          break;\n        }\n        if (noBuf)\n          cbuf(bt + 131072);\n        var end = bt + add;\n        for (; bt < end; bt += 4) {\n          buf[bt] = buf[bt - dt];\n          buf[bt + 1] = buf[bt + 1 - dt];\n          buf[bt + 2] = buf[bt + 2 - dt];\n          buf[bt + 3] = buf[bt + 3 - dt];\n        }\n        bt = end;\n      }\n    }\n    st.l = lm, st.p = lpos, st.b = bt;\n    if (lm)\n      final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n  } while (!final);\n  return bt === buf.length ? buf : slc(buf, 0, bt);\n};\nvar wbits = function (d, p, v) {\n  v <<= p & 7;\n  var o = p >> 3 | 0;\n  d[o] |= v;\n  d[o + 1] |= v >>> 8;\n};\nvar wbits16 = function (d, p, v) {\n  v <<= p & 7;\n  var o = p >> 3 | 0;\n  d[o] |= v;\n  d[o + 1] |= v >>> 8;\n  d[o + 2] |= v >>> 16;\n};\nvar hTree = function (d, mb) {\n  var t = [];\n  for (var i = 0; i < d.length; ++i) {\n    if (d[i])\n      t.push({ s: i, f: d[i] });\n  }\n  var s = t.length;\n  var t2 = t.slice();\n  if (!s)\n    return [et, 0];\n  if (s === 1) {\n    var v = new u8(t[0].s + 1);\n    v[t[0].s] = 1;\n    return [v, 1];\n  }\n  t.sort(function (a, b) {\n    return a.f - b.f;\n  });\n  t.push({ s: -1, f: 25001 });\n  var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n  t[0] = { s: -1, f: l.f + r.f, l, r };\n  while (i1 !== s - 1) {\n    l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n    r = t[i0 !== i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n    t[i1++] = { s: -1, f: l.f + r.f, l, r };\n  }\n  var maxSym = t2[0].s;\n  for (var i = 1; i < s; ++i) {\n    if (t2[i].s > maxSym)\n      maxSym = t2[i].s;\n  }\n  var tr = new u16(maxSym + 1);\n  var mbt = ln(t[i1 - 1], tr, 0);\n  if (mbt > mb) {\n    var i = 0, dt = 0;\n    var lft = mbt - mb, cst = 1 << lft;\n    t2.sort(function (a, b) {\n      return tr[b.s] - tr[a.s] || a.f - b.f;\n    });\n    for (; i < s; ++i) {\n      var i2_1 = t2[i].s;\n      if (tr[i2_1] > mb) {\n        dt += cst - (1 << mbt - tr[i2_1]);\n        tr[i2_1] = mb;\n      } else\n        break;\n    }\n    dt >>>= lft;\n    while (dt > 0) {\n      var i2_2 = t2[i].s;\n      if (tr[i2_2] < mb)\n        dt -= 1 << mb - tr[i2_2]++ - 1;\n      else\n        ++i;\n    }\n    for (; i >= 0 && dt; --i) {\n      var i2_3 = t2[i].s;\n      if (tr[i2_3] === mb) {\n        --tr[i2_3];\n        ++dt;\n      }\n    }\n    mbt = mb;\n  }\n  return [new u8(tr), mbt];\n};\nvar ln = function (n, l, d) {\n  return n.s === -1 ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1)) : l[n.s] = d;\n};\nvar lc = function (c) {\n  var s = c.length;\n  while (s && !c[--s])\n    ;\n  var cl = new u16(++s);\n  var cli = 0, cln = c[0], cls = 1;\n  var w = function (v) {\n    cl[cli++] = v;\n  };\n  for (var i = 1; i <= s; ++i) {\n    if (c[i] === cln && i !== s)\n      ++cls;\n    else {\n      if (!cln && cls > 2) {\n        for (; cls > 138; cls -= 138)\n          w(32754);\n        if (cls > 2) {\n          w(cls > 10 ? cls - 11 << 5 | 28690 : cls - 3 << 5 | 12305);\n          cls = 0;\n        }\n      } else if (cls > 3) {\n        w(cln), --cls;\n        for (; cls > 6; cls -= 6)\n          w(8304);\n        if (cls > 2)\n          w(cls - 3 << 5 | 8208), cls = 0;\n      }\n      while (cls--)\n        w(cln);\n      cls = 1;\n      cln = c[i];\n    }\n  }\n  return [cl.subarray(0, cli), s];\n};\nvar clen = function (cf, cl) {\n  var l = 0;\n  for (var i = 0; i < cl.length; ++i)\n    l += cf[i] * cl[i];\n  return l;\n};\nvar wfblk = function (out, pos, dat) {\n  var s = dat.length;\n  var o = shft(pos + 2);\n  out[o] = s & 255;\n  out[o + 1] = s >>> 8;\n  out[o + 2] = out[o] ^ 255;\n  out[o + 3] = out[o + 1] ^ 255;\n  for (var i = 0; i < s; ++i)\n    out[o + i + 4] = dat[i];\n  return (o + 4 + s) * 8;\n};\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n  wbits(out, p++, final);\n  ++lf[256];\n  var _a2 = hTree(lf, 15), dlt = _a2[0], mlb = _a2[1];\n  var _b2 = hTree(df, 15), ddt = _b2[0], mdb = _b2[1];\n  var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n  var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n  var lcfreq = new u16(19);\n  for (var i = 0; i < lclt.length; ++i)\n    lcfreq[lclt[i] & 31]++;\n  for (var i = 0; i < lcdt.length; ++i)\n    lcfreq[lcdt[i] & 31]++;\n  var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n  var nlcc = 19;\n  for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n    ;\n  var flen = bl + 5 << 3;\n  var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n  var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n  if (flen <= ftlen && flen <= dtlen)\n    return wfblk(out, p, dat.subarray(bs, bs + bl));\n  var lm, ll, dm, dl;\n  wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n  if (dtlen < ftlen) {\n    lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n    var llm = hMap(lct, mlcb, 0);\n    wbits(out, p, nlc - 257);\n    wbits(out, p + 5, ndc - 1);\n    wbits(out, p + 10, nlcc - 4);\n    p += 14;\n    for (var i = 0; i < nlcc; ++i)\n      wbits(out, p + 3 * i, lct[clim[i]]);\n    p += 3 * nlcc;\n    var lcts = [lclt, lcdt];\n    for (var it = 0; it < 2; ++it) {\n      var clct = lcts[it];\n      for (var i = 0; i < clct.length; ++i) {\n        var len = clct[i] & 31;\n        wbits(out, p, llm[len]), p += lct[len];\n        if (len > 15)\n          wbits(out, p, clct[i] >>> 5 & 127), p += clct[i] >>> 12;\n      }\n    }\n  } else {\n    lm = flm, ll = flt, dm = fdm, dl = fdt;\n  }\n  for (var i = 0; i < li; ++i) {\n    if (syms[i] > 255) {\n      var len = syms[i] >>> 18 & 31;\n      wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n      if (len > 7)\n        wbits(out, p, syms[i] >>> 23 & 31), p += fleb[len];\n      var dst = syms[i] & 31;\n      wbits16(out, p, dm[dst]), p += dl[dst];\n      if (dst > 3)\n        wbits16(out, p, syms[i] >>> 5 & 8191), p += fdeb[dst];\n    } else {\n      wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n    }\n  }\n  wbits16(out, p, lm[256]);\n  return p + ll[256];\n};\nvar deo = new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\nvar et = new u8(0);\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n  var s = dat.length;\n  var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7e3)) + post);\n  var w = o.subarray(pre, o.length - post);\n  var pos = 0;\n  if (!lvl || s < 8) {\n    for (var i = 0; i <= s; i += 65535) {\n      var e = i + 65535;\n      if (e < s) {\n        pos = wfblk(w, pos, dat.subarray(i, e));\n      } else {\n        w[i] = lst;\n        pos = wfblk(w, pos, dat.subarray(i, s));\n      }\n    }\n  } else {\n    var opt = deo[lvl - 1];\n    var n = opt >>> 13, c = opt & 8191;\n    var msk_1 = (1 << plvl) - 1;\n    var prev = new u16(32768), head = new u16(msk_1 + 1);\n    var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n    var hsh = function (i2) {\n      return (dat[i2] ^ dat[i2 + 1] << bs1_1 ^ dat[i2 + 2] << bs2_1) & msk_1;\n    };\n    var syms = new u32(25e3);\n    var lf = new u16(288), df = new u16(32);\n    var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n    for (; i < s; ++i) {\n      var hv = hsh(i);\n      var imod = i & 32767, pimod = head[hv];\n      prev[imod] = pimod;\n      head[hv] = imod;\n      if (wi <= i) {\n        var rem = s - i;\n        if ((lc_1 > 7e3 || li > 24576) && rem > 423) {\n          pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n          li = lc_1 = eb = 0, bs = i;\n          for (var j = 0; j < 286; ++j)\n            lf[j] = 0;\n          for (var j = 0; j < 30; ++j)\n            df[j] = 0;\n        }\n        var l = 2, d = 0, ch_1 = c, dif = imod - pimod & 32767;\n        if (rem > 2 && hv === hsh(i - dif)) {\n          var maxn = Math.min(n, rem) - 1;\n          var maxd = Math.min(32767, i);\n          var ml = Math.min(258, rem);\n          while (dif <= maxd && --ch_1 && imod !== pimod) {\n            if (dat[i + l] === dat[i + l - dif]) {\n              var nl = 0;\n              for (; nl < ml && dat[i + nl] === dat[i + nl - dif]; ++nl)\n                ;\n              if (nl > l) {\n                l = nl, d = dif;\n                if (nl > maxn)\n                  break;\n                var mmd = Math.min(dif, nl - 2);\n                var md = 0;\n                for (var j = 0; j < mmd; ++j) {\n                  var ti = i - dif + j + 32768 & 32767;\n                  var pti = prev[ti];\n                  var cd = ti - pti + 32768 & 32767;\n                  if (cd > md)\n                    md = cd, pimod = ti;\n                }\n              }\n            }\n            imod = pimod, pimod = prev[imod];\n            dif += imod - pimod + 32768 & 32767;\n          }\n        }\n        if (d) {\n          syms[li++] = 268435456 | revfl[l] << 18 | revfd[d];\n          var lin = revfl[l] & 31, din = revfd[d] & 31;\n          eb += fleb[lin] + fdeb[din];\n          ++lf[257 + lin];\n          ++df[din];\n          wi = i + l;\n          ++lc_1;\n        } else {\n          syms[li++] = dat[i];\n          ++lf[dat[i]];\n        }\n      }\n    }\n    pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n    if (!lst && pos & 7)\n      pos = wfblk(w, pos + 1, et);\n  }\n  return slc(o, 0, pre + shft(pos) + post);\n};\nvar adler = function () {\n  var a = 1, b = 0;\n  return {\n    p: function (d) {\n      var n = a, m = b;\n      var l = d.length | 0;\n      for (var i = 0; i !== l;) {\n        var e = Math.min(i + 2655, l);\n        for (; i < e; ++i)\n          m += n += d[i];\n        n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n      }\n      a = n, b = m;\n    },\n    d: function () {\n      a %= 65521, b %= 65521;\n      return (a & 255) << 24 | a >>> 8 << 16 | (b & 255) << 8 | b >>> 8;\n    }\n  };\n};\nvar dopt = function (dat, opt, pre, post, st) {\n  return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : 12 + opt.mem, pre, post, !st);\n};\nvar wbytes = function (d, b, v) {\n  for (; v; ++b)\n    d[b] = v, v >>>= 8;\n};\nvar zlh = function (c, o) {\n  var lv = o.level, fl2 = lv === 0 ? 0 : lv < 6 ? 1 : lv === 9 ? 3 : 2;\n  c[0] = 120, c[1] = fl2 << 6 | (fl2 ? 32 - 2 * fl2 : 1);\n};\nvar zlv = function (d) {\n  if ((d[0] & 15) !== 8 || d[0] >>> 4 > 7 || (d[0] << 8 | d[1]) % 31)\n    throw \"invalid zlib data\";\n  if (d[1] & 32)\n    throw \"invalid zlib data: preset dictionaries not supported\";\n};\nfunction zlibSync(data, opts) {\n  if (!opts)\n    opts = {};\n  var a = adler();\n  a.p(data);\n  var d = dopt(data, opts, 2, 4);\n  return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\nfunction unzlibSync(data, out) {\n  return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n\n// bundle.js\nfunction compress(buf, level) {\n  return zlibSync(buf, { level });\n}\n\nfunction decompress(buf, limit) {\n  return unzlibSync(buf, new Uint8Array(limit));\n}\n\nmodule.exports = {\n  compress,\n  decompress\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(655);\n"],"sourceRoot":""}